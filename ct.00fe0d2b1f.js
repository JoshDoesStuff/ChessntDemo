(()=>{var t,e=Object.defineProperty,i=Object.defineProperties,o=Object.getOwnPropertyDescriptors,n=Object.getOwnPropertySymbols,s=Object.prototype.hasOwnProperty,r=Object.prototype.propertyIsEnumerable,a=(t,i,o)=>i in t?e(t,i,{enumerable:!0,configurable:!0,writable:!0,value:o}):t[i]=o,l=(t,e)=>{for(var i in e||={})s.call(e,i)&&a(t,i,e[i]);if(n)for(var i of n(e))r.call(e,i)&&a(t,i,e[i]);return t},h=(t,e)=>i(t,o(e)),c=(t=>"undefined"!=typeof require?require:"undefined"!=typeof Proxy?new Proxy(t,{get:(t,e)=>("undefined"!=typeof require?require:t)[e]}):t)((function(t){if("undefined"!=typeof require)return require.apply(this,arguments);throw new Error('Dynamic require of "'+t+'" is not supported')})),d=(t,e,i)=>{if(!e.has(t))throw TypeError("Cannot "+i)},p=(t,e,i)=>(d(t,e,"read from private field"),i?i.call(t):e.get(t)),m=(t,e,i)=>{if(e.has(t))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(t):e.set(t,i)},f=(t,e,i,o)=>(d(t,e,"write to private field"),o?o.call(t,i):e.set(t,i),i),y=(t,e,i)=>(d(t,e,"access private method"),i),g=(t,e,i)=>new Promise(((o,n)=>{var s=t=>{try{a(i.next(t))}catch(t){n(t)}},r=t=>{try{a(i.throw(t))}catch(t){n(t)}},a=t=>t.done?o(t.value):Promise.resolve(t.value).then(s,r);a((i=i.apply(t,e)).next())})),v=Symbol("time"),x=Symbol("roomUid"),w=Symbol("timeLeftOriginal"),b=Symbol("promiseResolve"),S=Symbol("promiseReject"),C=class{constructor(t,e,i=!1){this.rejected=!1,this.done=!1,this.settled=!1,this[x]=Ht.current.uid||null,this.name=e&&e.toString(),this.isUi=i,this[v]=0,this[w]=t/1e3,this.timeLeft=this[w],this.promise=new Promise(((t,e)=>{this[b]=t,this[S]=e})),I.timers.add(this)}then(t){return this.promise.then(t)}catch(t){return this.promise.catch(t)}get time(){return this[v]}set time(t){this[v]=t}update(){!0!==this.rejected&&!0!==this.done?(this[v]+=this.isUi?jt.timeUi:jt.time,Ht.current.uid!==this[x]&&null!==this[x]&&this.reject({info:"Room has been switched",from:"timer"}),0!==this.timeLeft&&(this.timeLeft=this[w]-this.time,this.timeLeft<=0&&this.resolve())):this.remove()}resolve(){this.settled||(this.done=!0,this.settled=!0,this[b](),this.remove())}reject(t){this.settled||(this.rejected=!0,this.settled=!0,this[S](t),this.remove())}remove(){I.timers.delete(this)}},I={timers:new Set,counter:0,add:(t,e)=>new C(t,e,!1),addUi:(t,e)=>new C(t,e,!0),updateTimers(){for(const t of this.timers)t.update()}},P=I,k=class extends PIXI.sound.filters.Filter{constructor(t,e){const{audioContext:i}=PIXI.sound.context,o=i.createPanner();o.panningModel="equalpower",o.distanceModel="inverse",o.refDistance=t,o.rolloffFactor=e;super(o),this._panner=o}reposition(t){t.kill||(this._panner.positionX.value=t.x/camera.referenceLength,this._panner.positionY.value=t.y/camera.referenceLength)}destroy(){super.destroy(),this._panner=null}},T=new Map,M=null!=(t=[])?t:[],E={};for(const t of M)E[t.name]=t;var O={},D=Object.keys(PIXI.sound.filters).filter((t=>"Filter"!==t&&"StreamFilter"!==t)),A={};for(const t of D)A[t]=PIXI.sound.filters[t];var X=(t,e)=>Math.random()*(e-t)+t,N=(t,e)=>{const i=PIXI.sound.exists(t)&&PIXI.sound.find(t);if(i)return e(i,t);if(t in O)return e(O[t],t);if(t in E){let i;for(const o of E[t].variants){const t=`pixiSound-${o.uid}`;i=e(O[t],t)}return i}throw new Error(`[sounds] Sound "${t}" was not found. Is it a typo?`)},L=(t,e)=>((t,e,i)=>{var o,n,s,r,a;const l=PIXI.sound.find(`pixiSound-${e.uid}`).play(i);return(null==(o=t.volume)?void 0:o.enabled)?l.volume=X(t.volume.min,t.volume.max)*((null==i?void 0:i.volume)||1):void 0!==(null==i?void 0:i.volume)&&(l.volume=i.volume),(null==(n=t.pitch)?void 0:n.enabled)?l.speed=X(t.pitch.min,t.pitch.max)*((null==i?void 0:i.speed)||1):void 0!==(null==i?void 0:i.speed)&&(l.speed=i.speed),(null==(s=t.distortion)?void 0:s.enabled)&&R.addDistortion(l,X(t.distortion.min,t.distortion.max)),(null==(r=t.reverb)?void 0:r.enabled)&&R.addReverb(l,X(t.reverb.secondsMin,t.reverb.secondsMax),X(t.reverb.decayMin,t.reverb.decayMax),t.reverb.reverse),(null==(a=t.eq)?void 0:a.enabled)&&R.addEqualizer(l,...t.eq.bands.map((t=>X(t.min,t.max)))),l})(t,t.variants[Math.floor(Math.random()*t.variants.length)],e),R={load(t){return g(this,null,(function*(){const e=[];return N(t,((t,i)=>{const o=PIXI.sound.play(i,{muted:!0});o instanceof Promise?(e.push(o),o.then((t=>{t.stop()}))):o.stop()})),yield Promise.all(e),t}))},play(t,e){if(t in E){const i=E[t];return L(i,e)}if(t in O)return O[t].play(e);throw new Error(`[sounds.play] Sound "${t}" was not found. Is it a typo?`)},playAt(t,e,i){const o=R.play(t,i),{panning:n}=E[t];return o instanceof Promise?o.then((t=>{R.addPannerFilter(t,e,n.refDistance,n.rolloffFactor)})):R.addPannerFilter(o,e,n.refDistance,n.rolloffFactor),o},stop(t){t?"string"==typeof t?N(t,(t=>t.stop())):t.stop():PIXI.sound.stopAll()},pause(t){t?N(t,(t=>t.pause())):PIXI.sound.pauseAll()},resume(t){t?N(t,(t=>t.resume())):PIXI.sound.resumeAll()},exists:t=>t in E||t in O,playing(t){if(!t)return PIXI.sound.isPlaying();if(t in O)return O[t].isPlaying;if(!(t in E))throw new Error(`[sounds] Sound "${t}" was not found. Is it a typo?`);for(const e of E[t].variants)if(O[`pixiSound-${e.uid}`].isPlaying)return!0;return!1},volume:(t,e)=>(void 0!==e&&("string"==typeof t?N(t,(t=>{t.volume=e})):t.volume=e),"string"==typeof t?N(t,(t=>t.volume)):t.volume),globalVolume(t){PIXI.sound.volumeAll=t},fade(t,e=0,i=1e3){const o={time:performance.now(),value:null};o.value=t?R.volume(t):PIXI.sound.context.volume;const n=s=>{const r=s-o.time,a=Math.min(r/i,1),l=o.value+(e-o.value)*a;t?R.volume(t,l):R.globalVolume(l),a<1&&requestAnimationFrame(n)};requestAnimationFrame(n)},addFilter(t,e,i){const o=e;if(o.preserved=i,!1===t)PIXI.sound.filtersAll=[...PIXI.sound.filtersAll||[],o];else if("string"==typeof t)N(t,(t=>{t.filters=[...t.filters||[],o]}));else{if(!t)throw new Error(`[sounds.addFilter] Invalid sound: ${t}`);t.filters=[...t.filters||[],o]}},addDistortion(t,e){const i=new PIXI.sound.filters.DistortionFilter(e);return R.addFilter(t,i,"DistortionFilter"),i},addEqualizer(t,e,i,o,n,s,r,a,l,h,c){const d=new PIXI.sound.filters.EqualizerFilter(e,i,o,n,s,r,a,l,h,c);return R.addFilter(t,d,"EqualizerFilter"),d},addMonoFilter(t){const e=new PIXI.sound.filters.MonoFilter;return R.addFilter(t,e,"MonoFilter"),e},addReverb(t,e,i,o){const n=new PIXI.sound.filters.ReverbFilter(e,i,o);return R.addFilter(t,n,"ReverbFilter"),n},addStereoFilter(t,e){const i=new PIXI.sound.filters.StereoFilter(e);return R.addFilter(t,i,"StereoFilter"),i},addPannerFilter(t,e,i,o){const n=new k(i,o);return R.addFilter(t,n,"PannerFilter"),T.set(e,n),t.on("end",(()=>{T.delete(e)})),n},addTelephone(t){const e=new PIXI.sound.filters.TelephoneFilter;return R.addFilter(t,e,"TelephoneFilter"),e},removeFilter(t,e){const i=e=>{"string"==typeof t?N(t,(t=>{t.filters=e})):t.filters=e};if(!t&&!e)return void(PIXI.sound.filtersAll=[]);if(t&&!e)return void i([]);let o;o=t?"string"==typeof t?N(t,(t=>t.filters)):t.filters:PIXI.sound.filtersAll,e&&!e.includes("Filter")&&(e+="Filter");const n=[...o];o.forEach(((t,i)=>{t.preserved===e&&n.splice(i,1)})),t?i(n):PIXI.sound.filtersAll=n},speed(t,e){if(e)return"string"==typeof t?N(t,(t=>{t.speed=e})):t.speed=e,e;if("string"==typeof t){if(t in E)return O[E[t].variants[0].uid].speed;if(t in O)return O[t].speed;throw new Error(`[sounds.speed] Invalid sound name: ${t}. Is it a typo?`)}return t.speed},speedAll(t){PIXI.sound.speedAll=t},toggleMuteAll:()=>PIXI.sound.toggleMuteAll(),togglePauseAll:()=>PIXI.sound.togglePauseAll()},_=R,Y=document.querySelector(".ct-aLoadingScreen"),B=Y.querySelector(".ct-aLoadingBar"),K=t=>("/"===(t=t.replace(/\\/g,"/"))[0]&&(t=t.slice(1)),t.split("/").filter((t=>t))),F=t=>{if(!U.tree)throw new Error("[res] Asset tree was not exported; check your project's export settings.");let e=U.tree;for(const i of t){const o=e.find((t=>t.name===i&&"folder"===t.type));if(!o)throw new Error(`[res] Could not find folder ${i} in path ${t.join("/")}`);e=o.entries}return e},U={sounds:E,pixiSounds:O,textures:{},tree:!1,loadScript(t=Kt("url","ct.res.loadScript")){var e=document.createElement("script");e.src=t;const i=new Promise(((t,i)=>{e.onload=()=>{t()},e.onerror=()=>{i()}}));return document.getElementsByTagName("head")[0].appendChild(e),i},loadTexture(){return g(this,arguments,(function*(t=Kt("url","ct.res.loadTexture"),e=Kt("name","ct.res.loadTexture"),i={}){let o;try{o=yield PIXI.Assets.load(t)}catch(e){throw console.error(`[ct.res] Could not load image ${t}`),e}const n=[o];n.shape=o.shape=i.shape||{},o.defaultAnchor=n.defaultAnchor=new PIXI.Point(i.anchor.x||0,i.anchor.x||0);const s=jt.getHitArea(o.shape);return s&&(o.hitArea=n.hitArea=s),U.textures[e]=n,n}))},loadAtlas(){return g(this,arguments,(function*(t=Kt("url","ct.res.loadAtlas")){const e=yield PIXI.Assets.load(t);for(const t in e.animations){const i=e.animations[t],o=e.data.animations;for(let n=0,s=o[t].length;n<s;n++){const s=o[t][n];i[n].shape=e.data.frames[s].shape}i.shape=i[0].shape||{},U.textures[t]=i;const n=jt.getHitArea(U.textures[t].shape);if(n){U.textures[t].hitArea=n;for(const e of U.textures[t])e.hitArea=n}}return Object.keys(e.animations)}))},unloadAtlas(){return g(this,arguments,(function*(t=Kt("url","ct.res.unloadAtlas")){const{animations:e}=PIXI.Assets.get(t);if(e){for(const t of e)delete U.textures[t];yield PIXI.Assets.unload(t)}else console.log(`[ct.res] Attempt to unload an atlas that was not loaded/was unloaded already: ${t}`)}))},loadBitmapFont(){return g(this,arguments,(function*(t=Kt("url","ct.res.loadBitmapFont")){yield PIXI.Assets.load(t)}))},unloadBitmapFont(){return g(this,arguments,(function*(t=Kt("url","ct.res.unloadBitmapFont")){yield PIXI.Assets.unload(t)}))},loadSound:(t=Kt("path","ct.res.loadSound"),e=Kt("name","ct.res.loadSound"),i=!0)=>new Promise(((o,n)=>{const s=PIXI.sound.add(e,{url:t,preload:i,loaded:i?t=>{t?n(t):(U.pixiSounds[e]=s,o(e))}:void 0});i||o(e)})),loadGame(){return g(this,null,(function*(){const t=["./img/a0.{webp,png}.5117318f13.json"],e={background:{source:"./img/t0.20f8129c53.{webp,png}",shape:{type:"rect",top:360,bottom:360,left:640,right:640},anchor:{x:.5,y:.5}}},i={},o=t.length;let n=0;const s=[];s.push(...t.map((t=>U.loadAtlas(t).then((t=>{var e;return n++,e=n/o*100,Y.setAttribute("data-progress",String(e)),B.style.width=e+"%",t})))));for(const t in e)s.push(U.loadTexture(e[t].source,t,{anchor:e[t].anchor,shape:e[t].shape}));for(const t in i)s.push(U.loadBitmapFont(i[t]));for(const t of M)for(const e of t.variants)s.push(U.loadSound(e.source,`pixiSound-${e.uid}`,t.preload));yield Promise.all(s),Y.classList.add("hidden")}))},getTexture:(t,e)=>{if(null===e&&(e=void 0),-1===t)return void 0!==e?PIXI.Texture.EMPTY:[PIXI.Texture.EMPTY];if(!(t in U.textures))throw new Error(`Attempt to get a non-existent texture ${t}`);const i=U.textures[t];return void 0!==e?i[e]:i},getTextureShape(t){if(-1===t)return{type:"point"};if(!(t in U.textures))throw new Error(`Attempt to get a shape of a non-existent texture ${t}`);return U.textures[t].shape},getChildren:t=>F(K(t||"")).filter((t=>"folder"!==t.type)),getOfType:(t,e)=>F(K(e||"")).filter((e=>e.type===t)),getAll(t){const e=F(K(t||"")),i=[],o=t=>{for(const e of t)"folder"===e.type?o(e.entries):i.push(e)};return o(e),i},getAllOfType(t,e){const i=F(K(e||"")),o=[],n=e=>{for(const i of e)"folder"===i.type&&n(i.entries),i.type===t&&o.push(i)};return n(i),o}};if(document.fonts)for(const t of document.fonts)t.load();var j,$,z,W,H=U,q={},G=class extends PIXI.TilingSprite{constructor(t,e=0,i=0,o={movementX:0,movementY:0,parallaxX:0,parallaxY:0,repeat:"repeat",scaleX:0,scaleY:0,shiftX:0,shiftY:0}){let{width:n,height:s}=Bt;const r=t instanceof PIXI.Texture?t:H.getTexture(t,e||0);"no-repeat"!==o.repeat&&"repeat-x"!==o.repeat||(s=r.height*(o.scaleY||1)),"no-repeat"!==o.repeat&&"repeat-y"!==o.repeat||(n=r.width*(o.scaleX||1)),super(r,n,s),this.parallaxX=1,this.parallaxY=1,this.shiftX=0,this.shiftY=0,this.movementX=0,this.movementY=0,"string"==typeof t?(q[t]||(q[t]=[]),q[t].push(this)):(q.OTHER||(q.OTHER=[]),q.OTHER.push(this)),_t.list.BACKGROUND.push(this),me.push(this),this.on("destroyed",(()=>{_t.list.BACKGROUND.splice(_t.list.BACKGROUND.indexOf(this),1),me.splice(me.indexOf(this),1)})),this.zIndex=i,this.anchor.set(0,0),o&&Object.assign(this,o),this.scaleX&&(this.tileScale.x=Number(this.scaleX)),this.scaleY&&(this.tileScale.y=Number(this.scaleY)),this.reposition()}onStep(){this.shiftX+=jt.time*this.movementX,this.shiftY+=jt.time*this.movementY}reposition(){const t=this.isUi?{x:0,y:0,width:Bt.width,height:Bt.height}:Bt.getBoundingBox(),e=Bt.x-Bt.width/2,i=Bt.y-Bt.height/2;"repeat-x"!==this.repeat&&"no-repeat"!==this.repeat?(this.y=t.y,this.tilePosition.y=-this.y-i*(this.parallaxY-1)+this.shiftY,this.height=t.height+1):this.y=this.shiftY+t.y*(this.parallaxY-1),"repeat-y"!==this.repeat&&"no-repeat"!==this.repeat?(this.x=t.x,this.tilePosition.x=-this.x-e*(this.parallaxX-1)+this.shiftX,this.width=t.width+1):this.x=this.shiftX+t.x*(this.parallaxX-1)}onDraw(){this.reposition()}static onCreate(){}static onDestroy(){}get isUi(){return!!this.parent&&Boolean(this.parent.isUi)}},J={list:q,add(t,e=0,i=0,o){if(o||(o=Ht.current),!t)throw new Error("[backgrounds] The texName argument is required.");const n=new G(t,e,i);return o instanceof zt&&o.backgrounds.push(n),o.addChild(n),n}},V=class extends PIXI.Sprite{},Q=class extends PIXI.Container{},Z=class extends PIXI.Container{constructor(t){if(super(),this.pixiTiles=[],t){this.zIndex=t.depth,this.tiles=t.tiles.map((t=>l({},t))),t.extends&&Object.assign(this,t.extends);for(let e=0,i=t.tiles.length;e<i;e++){const i=t.tiles[e],o=H.getTexture(i.texture),n=new V(o[i.frame]);n.anchor.x=o[0].defaultAnchor.x,n.anchor.y=o[0].defaultAnchor.y,n.shape=o.shape,n.scale.set(i.scale.x,i.scale.y),n.rotation=i.rotation,n.alpha=i.opacity,n.tint=i.tint,n.x=i.x,n.y=i.y,this.addChild(n),this.pixiTiles.push(n),this.tiles[e].sprite=n}t.cache&&this.cache()}else this.tiles=[];_t.list.TILEMAP.push(this),this.on("destroyed",(()=>{_t.list.TILEMAP.splice(_t.list.TILEMAP.indexOf(this),1)}))}addTile(t,e,i,o=0){if(this.cached)throw new Error("[ct.tiles] Adding tiles to cached tilemaps is forbidden. Create a new tilemap, or add tiles before caching the tilemap.");const n=H.getTexture(t,o),s=new V(n);return s.x=e,s.y=i,s.shape=n.shape,this.tiles.push({texture:t,frame:o,x:e,y:i,width:s.width,height:s.height,sprite:s,opacity:1,rotation:1,scale:{x:1,y:1},tint:16777215}),this.addChild(s),this.pixiTiles.push(s),s}cache(t=1024){if(this.cached)throw new Error("[ct.tiles] Attempt to cache an already cached tilemap.");const e=this.getLocalBounds(),i=Math.ceil(e.width/t),o=Math.ceil(e.height/t);this.cells=[];for(let t=0;t<o;t++)for(let t=0;t<i;t++){const t=new Q;this.cells.push(t)}for(let o=0,n=this.tiles.length;o<n;o++){const[o]=this.children,n=Math.floor((o.x-e.x)/t),s=Math.floor((o.y-e.y)/t);this.cells[s*i+n].addChild(o)}this.removeChildren();for(let t=0,e=this.cells.length;t<e;t++)0!==this.cells[t].children.length?(this.addChild(this.cells[t]),pe.pixelart&&(this.cells[t].cacheAsBitmapResolution=1),this.cells[t].cacheAsBitmap=!0):(this.cells.splice(t,1),t--,e--);this.cached=!0}cacheDiamond(t=1024){if(this.cached)throw new Error("[ct.tiles] Attempt to cache an already cached tilemap.");this.cells=[],this.diamondCellMap={};for(let e=0,i=this.tiles.length;e<i;e++){const[e]=this.children,{x:i,y:o}=jt.rotate(e.x,2*e.y,-45),n=Math.floor(i/t),s=Math.floor(o/t),r=`${n}:${s}`;if(!(r in this.diamondCellMap)){const t=new Q;t.chunkX=n,t.chunkY=s,this.diamondCellMap[r]=t,this.cells.push(t)}this.diamondCellMap[r].addChild(e)}this.removeChildren(),this.cells.sort(((t,e)=>{const i=Math.max(t.chunkY,t.chunkX),o=Math.max(e.chunkY,e.chunkX);return i===o?e.chunkX-t.chunkX:i-o}));for(let t=0,e=this.cells.length;t<e;t++)this.addChild(this.cells[t]),this.cells[t].cacheAsBitmap=!0;this.cached=!0}},tt={create(t=0){const e=new Z;return e.zIndex=t,Ht.current.addChild(e),e},addTile:(t,e,i,o,n=0)=>t.addTile(e,i,o,n),cache(t,e){t.cache(e)},cacheDiamond(t,e){t.cacheDiamond(e)}},et={templates:{},rooms:{},add(t,e){if(t.behaviors.includes(e))throw new Error(`[behaviors.add] Behavior ${e} already exists on ${t instanceof zt?t.name:t.template}`);const i=t instanceof zt?"rooms":"templates";if("static"===et[i][e])throw new Error(`[behaviors.add] Behavior ${e} cannot be added to ${t instanceof zt?t.name:t.template} because this behavior cannot be added dynamically.`);if(!et[i][e])throw new Error(`[behaviors.add] Behavior ${e} does not exist or cannot be applied to ${i}.`);t.behaviors.push(e)},remove(t,e){if(!t.behaviors.includes(e))throw new Error(`[behaviors.remove] Behavior ${e} already exists on ${t instanceof zt?t.name:t.template}`);const i=t instanceof zt?"rooms":"templates";if("static"===et[i][e])throw new Error(`[behaviors.remove] Behavior ${e} cannot be removed from ${t instanceof zt?t.name:t.template} because this behavior cannot be removed dynamically.`);if(!et[i][e])throw new Error(`[behaviors.remove] Behavior ${e} does not exist or cannot be applied to ${i}.`);t.behaviors.splice(t.behaviors.indexOf(e),1)},has:(t,e)=>t.behaviors.includes(e)},it=(t,e,i)=>{var o;for(const n of t.behaviors){const s=et[e][n];"static"!==s&&s&&(null==(o=s[i])||o.apply(t))}},ot=et,nt={types:{},new:(t,e)=>(nt.types[t]=e,e),get:(t,e)=>!0===e?Object.assign({},nt.types[t]):e?Object.assign(Object.assign({},nt.types[t]),e):nt.types[t]},st=nt,rt=class extends PIXI.Container{constructor(t,e){var i,o,n,s,r,a,l,h;if("Button"!==(null==t?void 0:t.baseClass))throw new Error("Don't call PixiButton class directly! Use templates.copy to create an instance instead.");super(),m(this,j,void 0),this.normalTexture=H.getTexture(t.texture,0),this.hoverTexture=t.hoverTexture?H.getTexture(t.hoverTexture,0):this.normalTexture,this.pressedTexture=t.pressedTexture?H.getTexture(t.pressedTexture,0):this.normalTexture,this.disabledTexture=t.disabledTexture?H.getTexture(t.disabledTexture,0):this.normalTexture,this.panel=new PIXI.NineSlicePlane(this.normalTexture,null!=(o=null==(i=t.nineSliceSettings)?void 0:i.left)?o:16,null!=(s=null==(n=t.nineSliceSettings)?void 0:n.top)?s:16,null!=(a=null==(r=t.nineSliceSettings)?void 0:r.right)?a:16,null!=(h=null==(l=t.nineSliceSettings)?void 0:l.bottom)?h:16);const c=-1===t.textStyle?PIXI.TextStyle.defaultStyle:st.get(t.textStyle,!0);e.customSize&&(c.fontSize=Number(e.customSize)),this.textLabel=new PIXI.Text(e.customText||t.defaultText||"",c),this.textLabel.anchor.set(.5),this.addChild(this.panel,this.textLabel),this.eventMode="dynamic",this.cursor="pointer",this.on("pointerenter",this.hover),this.on("pointerentercapture",this.hover),this.on("pointerleave",this.blur),this.on("pointerleavecapture",this.blur),this.on("pointerdown",this.press),this.on("pointerdowncapture",this.press),this.on("pointerup",this.hover),this.on("pointerupcapture",this.hover),this.on("pointerupoutside",this.blur),this.on("pointerupoutsidecapture",this.blur),this.updateNineSliceShape=t.nineSliceSettings.autoUpdate;let d=this.panel.width,u=this.panel.height;"scaleX"in e&&(d*=e.scaleX),"scaleY"in e&&(u*=e.scaleY),this.resize(d,u),jt.reshapeNinePatch(this)}get disabled(){return p(this,j)}set disabled(t){f(this,j,t),t?(this.panel.texture=this.disabledTexture,this.eventMode="none"):(this.panel.texture=this.normalTexture,this.eventMode="dynamic")}get text(){return this.textLabel.text}set text(t){this.textLabel.text=t}get tint(){return this.panel.tint}set tint(t){this.panel.tint=t}unsize(){const{x:t,y:e}=this.scale;this.panel.scale.x*=t,this.panel.scale.y*=e,this.scale.set(1),this.textLabel.x=this.panel.width/2,this.textLabel.y=this.panel.height/2}resize(t,e){this.panel.width=t,this.panel.height=e,this.textLabel.x=t/2,this.textLabel.y=e/2}hover(){this.disabled||(this.panel.texture=this.hoverTexture)}blur(){this.disabled||(this.panel.texture=this.normalTexture)}press(){this.disabled||(this.panel.texture=this.pressedTexture)}};j=new WeakMap;var at,lt,ht=class extends PIXI.TilingSprite{constructor(t,e){var i,o;if("SpritedCounter"!==t.baseClass)throw new Error("Don't call PixiScrollingTexture class directly! Use templates.copy to create an instance instead.");const n=H.getTexture(t.texture,0);super(n,n.width,n.height),m(this,$,void 0),m(this,z,void 0),m(this,W,void 0),f(this,z,this.width),f(this,W,this.height),this.anchor.set(0),"scaleX"in e&&(this.scale.x=null!=(i=e.scaleX)?i:1),"scaleY"in e&&(this.scale.y=null!=(o=e.scaleY)?o:1),this.count=t.spriteCount}get count(){return p(this,$)}set count(t){f(this,$,t),this.width=p(this,$)*p(this,z)*this.scale.x,this.height=p(this,W)*this.scale.y,this.tileScale.set(this.scale.x,this.scale.y),this.shape={type:"rect",left:0,top:0,right:p(this,z)*p(this,$),bottom:p(this,W)}}};$=new WeakMap,z=new WeakMap,W=new WeakMap;var ct=class extends PIXI.TilingSprite{constructor(t,e){var i,o;if("RepeatingTexture"!==t.baseClass)throw new Error("Don't call PixiScrollingTexture class directly! Use templates.copy to create an instance instead.");const n=H.getTexture(t.texture,0);super(n,n.width,n.height),m(this,at,void 0),m(this,lt,void 0),f(this,at,this.width),f(this,lt,this.height),this.anchor.set(0),this.scrollSpeedX=t.scrollX,this.scrollSpeedY=t.scrollY,"scaleX"in e&&(this.width=p(this,at)*(null!=(i=e.scaleX)?i:1)),"scaleY"in e&&(this.height=p(this,lt)*(null!=(o=e.scaleY)?o:1)),this.on("added",(()=>{Ht.current.tickerSet.add(this)})),this.on("removed",(()=>{Ht.current.tickerSet.delete(this)})),this.shape={type:"rect",left:0,top:0,right:this.width,bottom:this.height}}tick(){this.isUi?(this.tilePosition.x+=this.scrollSpeedX*jt.timeUi,this.tilePosition.y+=this.scrollSpeedY*jt.timeUi):(this.tilePosition.x+=this.scrollSpeedX*jt.time,this.tilePosition.y+=this.scrollSpeedY*jt.time)}};at=new WeakMap,lt=new WeakMap;var dt,ut,pt,mt,ft,yt,gt,vt,xt,wt,bt=document.createElement("style");document.head.appendChild(bt);var St=class extends PIXI.Container{constructor(t,e){var i,o,n,s,r,a,l,h,c,d;if("TextBox"!==(null==t?void 0:t.baseClass))throw new Error("Don't call PixiTextBox class directly! Use templates.copy to create an instance instead.");super(),m(this,mt),m(this,dt,void 0),m(this,ut,void 0),m(this,pt,void 0),m(this,yt,void 0),this.onchange=()=>{},this.oninput=()=>{},m(this,gt,(t=>{t.target!==this&&this.blur()})),m(this,vt,(t=>{"Enter"===t.key&&p(this,ut)&&(y(this,mt,ft).call(this,!1),t.preventDefault())})),m(this,xt,(()=>{var t,e,i,o,n,s,r;const{isUi:a}=this.getRoom(),l=this.x,h=this.y,c=this.x+this.width,d=this.y+this.height,u=a?jt.uiToCssScalar:jt.gameToCssScalar,m=a?jt.uiToCssCoord:jt.gameToCssCoord,f=m(l,h),y=m(c,d),g=this.textLabel.style;if(Object.assign(p(this,yt).style,{fontSize:u(parseFloat(g.fontSize))+"px",left:f.x+"px",top:f.y+"px",width:y.x-f.x+"px",height:y.y-f.y+"px",lineHeight:y.y-f.y+"px",color:Array.isArray(g.fill)?g.fill[0]:g.fill}),g.strokeThickness?(p(this,yt).style.textStroke=`${u(g.strokeThickness/2)}px ${g.stroke}`,p(this,yt).style.webkitTextStroke=p(this,yt).style.textStroke):p(this,yt).style.textStroke=p(this,yt).style.webkitTextStroke="unset",g.dropShadow){const n=jt.radToDeg(null!=(t=g.dropShadowAngle)?t:0);let s=jt.ldx(null!=(e=g.dropShadowDistance)?e:0,n),r=jt.ldy(null!=(i=g.dropShadowDistance)?i:0,n);s=u(s),r=u(r);const a=`${s}px ${r}px ${u(null!=(o=g.dropShadowBlur)?o:0)}px ${g.dropShadowColor}`;p(this,yt).style.textShadow=`${a}, ${a}`}p(this,yt).style.fontStyle=null!=(n=g.fontStyle)?n:"unset",p(this,yt).style.fontFamily=null!=(s=g.fontFamily)?s:"unset",p(this,yt).style.fontWeight=null!=(r=g.fontWeight)?r:"400",this.selectionColor?bt.innerHTML=`\n                ::selection {\n                    background: ${this.selectionColor};\n                }\n            `:bt.innerHTML=""})),m(this,wt,void 0),this.normalTexture=H.getTexture(t.texture,0),this.hoverTexture=t.hoverTexture?H.getTexture(t.hoverTexture,0):this.normalTexture,this.pressedTexture=t.pressedTexture?H.getTexture(t.pressedTexture,0):this.normalTexture,this.disabledTexture=t.disabledTexture?H.getTexture(t.disabledTexture,0):this.normalTexture,this.panel=new PIXI.NineSlicePlane(this.normalTexture,null!=(o=null==(i=t.nineSliceSettings)?void 0:i.left)?o:16,null!=(s=null==(n=t.nineSliceSettings)?void 0:n.top)?s:16,null!=(a=null==(r=t.nineSliceSettings)?void 0:r.right)?a:16,null!=(h=null==(l=t.nineSliceSettings)?void 0:l.bottom)?h:16),this.maxLength=null!=(c=t.maxTextLength)?c:0,this.fieldType=null!=(d=t.fieldType)?d:"text";const u=-1===t.textStyle?PIXI.TextStyle.defaultStyle:st.get(t.textStyle,!0);e.customSize&&(u.fontSize=Number(e.customSize));let g=e.customText||t.defaultText||"";f(this,wt,g),"password"===this.fieldType&&(g="•".repeat(g.length)),this.textLabel=new PIXI.Text(g,u),this.textLabel.anchor.set(.5),this.addChild(this.panel,this.textLabel),t.selectionColor&&(this.selectionColor=t.selectionColor),this.eventMode="dynamic",this.cursor="pointer",this.on("pointerenter",this.hover),this.on("pointerentercapture",this.hover),this.on("pointerleave",this.unhover),this.on("pointerleavecapture",this.unhover),this.on("pointerdown",this.press),this.on("pointerdowncapture",this.press),this.on("pointerup",this.hover),this.on("pointerupcapture",this.hover),this.on("pointerupoutside",this.unhover),this.on("pointerupoutsidecapture",this.unhover),this.updateNineSliceShape=t.nineSliceSettings.autoUpdate;let v=this.panel.width,x=this.panel.height;"scaleX"in e&&(v*=e.scaleX),"scaleY"in e&&(x*=e.scaleY),this.resize(v,x),jt.reshapeNinePatch(this),f(this,dt,!1),f(this,ut,!1),f(this,yt,document.createElement("input")),p(this,yt).type="text",p(this,yt).className="aCtJsTextboxInput",p(this,yt).addEventListener("click",(t=>{t.stopPropagation()})),p(this,yt).addEventListener("pointerup",(t=>{t.stopPropagation()})),p(this,yt).addEventListener("input",(()=>{this.oninput(p(this,yt).value)})),this.on("pointerup",(()=>{y(this,mt,ft).call(this,!0)}))}get disabled(){return p(this,dt)}set disabled(t){f(this,dt,t),t?(this.panel.texture=this.disabledTexture,this.eventMode="none"):(this.panel.texture=this.normalTexture,this.eventMode="auto")}get isFocused(){return p(this,ut)}blur(){y(this,mt,ft).call(this,!1)}focus(){y(this,mt,ft).call(this,!0)}get text(){return p(this,wt)}set text(t){f(this,wt,t),"password"===this.fieldType?this.textLabel.text="•".repeat(t.length):this.textLabel.text=t}unsize(){const{x:t,y:e}=this.scale;this.panel.scale.x*=t,this.panel.scale.y*=e,this.scale.set(1),this.textLabel.x=this.panel.width/2,this.textLabel.y=this.panel.height/2}resize(t,e){this.panel.width=t,this.panel.height=e,this.textLabel.x=t/2,this.textLabel.y=e/2}hover(){this.disabled||(this.panel.texture=this.hoverTexture)}unhover(){this.disabled||(this.panel.texture=this.normalTexture)}press(){this.disabled||(this.panel.texture=this.pressedTexture)}};dt=new WeakMap,ut=new WeakMap,pt=new WeakMap,mt=new WeakSet,ft=function(t){var e,i;if(t!==p(this,ut))if(f(this,ut,t),t){if(p(this,dt))return void f(this,ut,!1);Dt(this),this.panel.texture=null!=(i=null!=(e=this.pressedTexture)?e:this.hoverTexture)?i:this.normalTexture,p(this,xt).call(this),this.maxLength>0?p(this,yt).maxLength=this.maxLength:delete p(this,yt).maxLength,p(this,yt).type=this.fieldType,p(this,yt).value=this.text,document.body.appendChild(p(this,yt)),p(this,yt).focus(),this.textLabel.alpha=0;try{f(this,pt,pe.preventDefault),pe.preventDefault=!1}catch(t){}document.addEventListener("keydown",p(this,vt)),window.addEventListener("resize",p(this,xt)),le.stage.off("pointerup",p(this,gt))}else{this.panel.texture=this.normalTexture,this.text=p(this,yt).value,document.body.removeChild(p(this,yt)),this.textLabel.alpha=1;try{pe.preventDefault=p(this,pt)}catch(t){}this.onchange(this.text),document.removeEventListener("keydown",p(this,vt)),window.removeEventListener("resize",p(this,xt)),le.stage.on("pointerup",p(this,gt))}},yt=new WeakMap,gt=new WeakMap,vt=new WeakMap,xt=new WeakMap,wt=new WeakMap;var Ct,It,Pt,kt=class extends PIXI.NineSlicePlane{constructor(t,e){var i,o,n,s,r,a,l,h;if("NineSlicePlane"!==(null==t?void 0:t.baseClass))throw new Error("Don't call PixiPanel class directly! Use templates.copy to create an instance instead.");super(H.getTexture(t.texture,0),null!=(o=null==(i=t.nineSliceSettings)?void 0:i.left)?o:16,null!=(s=null==(n=t.nineSliceSettings)?void 0:n.top)?s:16,null!=(a=null==(r=t.nineSliceSettings)?void 0:r.right)?a:16,null!=(h=null==(l=t.nineSliceSettings)?void 0:l.bottom)?h:16),this.baseClass="NineSlicePlane",this.updateNineSliceShape=t.nineSliceSettings.autoUpdate;const c=this.width,d=this.height;"scaleX"in e&&(this.width=c*e.scaleX),"scaleY"in e&&(this.height=d*e.scaleY),jt.reshapeNinePatch(this),this.blendMode=t.blendMode||PIXI.BLEND_MODES.NORMAL}},Tt=class extends PIXI.Text{constructor(t,e){var i,o,n,s;if("Text"!==(null==t?void 0:t.baseClass))throw new Error("Don't call PixiPanel class directly! Use templates.copy to create an instance instead.");let r;if(r=t.textStyle&&-1!==t.textStyle?st.get(t.textStyle,!0):{},e.customWordWrap&&(r.wordWrap=!0,r.wordWrapWidth=Number(e.customWordWrap)),e.customSize&&(r.fontSize=Number(e.customSize)),super(e.customText||t.defaultText||"",r),e.customAnchor){const t=e.customAnchor;this.anchor.set(null!=(i=null==t?void 0:t.x)?i:0,null!=(o=null==t?void 0:t.y)?o:0)}return this.shape=jt.getRectShape(this),this.scale.set(null!=(n=e.scaleX)?n:1,null!=(s=e.scaleY)?s:1),this}},Mt=class extends PIXI.Container{constructor(){return super(),this.shape={type:"point"},this}},Et={AnimatedSprite:class extends PIXI.AnimatedSprite{constructor(t,e){var i,o,n,s,r,a;if("AnimatedSprite"!==(null==t?void 0:t.baseClass))throw new Error("Don't call PixiButton class directly! Use templates.copy to create an instance instead.");const l=H.getTexture(t.texture);return super(l),this.anchor.x=null!=(o=null!=(i=t.anchorX)?i:l[0].defaultAnchor.x)?o:0,this.anchor.y=null!=(s=null!=(n=t.anchorY)?n:l[0].defaultAnchor.y)?s:0,this.scale.set(null!=(r=e.scaleX)?r:1,null!=(a=e.scaleY)?a:1),this.blendMode=t.blendMode||PIXI.BLEND_MODES.NORMAL,this.loop=t.loopAnimation,this.animationSpeed=t.animationFPS/60,t.playAnimationOnStart&&this.play(),this}},Button:rt,Container:Mt,NineSlicePlane:kt,RepeatingTexture:ct,SpritedCounter:ht,Text:Tt,TextBox:St},Ot=0,Dt=t=>{Ct&&Ct!==t&&Ct.blur(),Ct=t},At={set tex(t){if(this._tex!==t){var{playing:e}=this;this.textures=H.getTexture(t),[this.texture]=this.textures,this._tex=t,this.shape=H.getTextureShape(t),this.hitArea=this.textures.hitArea,this.anchor&&(this.anchor.x=this.textures[0].defaultAnchor.x,this.anchor.y=this.textures[0].defaultAnchor.y,e&&this.play()),"_bottomHeight"in this&&jt.reshapeNinePatch(this)}},get tex(){return this._tex},get speed(){return Math.hypot(this.hspeed,this.vspeed)},set speed(t){if(0===t)return this._zeroDirection=this.direction,void(this.hspeed=this.vspeed=0);if(0===this.speed){const e=this._zeroDirection;return this._hspeed=t*Math.cos(e*Math.PI/180),void(this._vspeed=t*Math.sin(e*Math.PI/180))}var e=t/this.speed;this.hspeed*=e,this.vspeed*=e},get hspeed(){return this._hspeed},set hspeed(t){0===this.vspeed&&0===t&&(this._zeroDirection=this.direction),this._hspeed=t},get vspeed(){return this._vspeed},set vspeed(t){0===this.hspeed&&0===t&&(this._zeroDirection=this.direction),this._vspeed=t},get direction(){return 0===this.speed?this._zeroDirection:(180*Math.atan2(this.vspeed,this.hspeed)/Math.PI+360)%360},set direction(t){if(this._zeroDirection=t,this.speed>0){var{speed:e}=this;this.hspeed=e*Math.cos(t*Math.PI/180),this.vspeed=e*Math.sin(t*Math.PI/180)}},move(){this.gravity&&(this.hspeed+=this.gravity*jt.time*Math.cos(this.gravityDir*Math.PI/180),this.vspeed+=this.gravity*jt.time*Math.sin(this.gravityDir*Math.PI/180)),this.x+=this.hspeed*jt.time,this.y+=this.vspeed*jt.time},addSpeed(t,e){this.hspeed+=t*Math.cos(e*Math.PI/180),this.vspeed+=t*Math.sin(e*Math.PI/180)},getRoom(){let{parent:t}=this;for(;!(t instanceof zt);)({parent:t}=t);return t},onBeforeCreateModifier(){}},Xt=function(t,e,i,o,n){o=o||Ht.current,this[ae]=!0,i?(this.baseClass=i.baseClass,this.parent=o,"AnimatedSprite"!==i.baseClass&&"NineSlicePlane"!==i.baseClass||(this._tex=i.texture),this.behaviors=[...i.behaviors],!1===i.visible&&(this.visible=!1)):this.behaviors=[];const s=this.scale;return Object.defineProperty(this,"scale",{get:()=>s,set:t=>{this.scale.x=this.scale.y=Number(t)}}),this[ae]=!0,this.xprev=this.xstart=this.x=t,this.yprev=this.ystart=this.y=e,this._hspeed=0,this._vspeed=0,this._zeroDirection=0,this.gravity=0,this.gravityDir=90,this.zIndex=0,this.timer1=this.timer2=this.timer3=this.timer4=this.timer5=this.timer6=0,this.uid=++Ot,i?(Object.assign(this,{template:i.name,zIndex:i.depth,onStep:i.onStep,onDraw:i.onDraw,onBeforeCreateModifier:At.onBeforeCreateModifier,onCreate:i.onCreate,onDestroy:i.onDestroy}),this.zIndex=i.depth,Object.assign(this,i.extends),n&&Object.assign(this,n),"texture"in i&&!this.shape&&(this.shape=H.getTextureShape(i.texture||-1),"string"==typeof i.texture&&(this.hitArea=H.getTexture(i.texture).hitArea)),Rt.list[i.name]?Rt.list[i.name].push(this):Rt.list[i.name]=[this],this.onBeforeCreateModifier.apply(this),Rt.templates[i.name].onCreate.apply(this),Lt.apply(this)):n&&(Object.assign(this,n),this.onBeforeCreateModifier.apply(this),Lt.apply(this)),this.shape||(this.shape=H.getTextureShape(-1)),this.behaviors.length&&it(this,"templates","thisOnCreate"),this},Nt=(t,e,i,o,n)=>{if(!(t in Rt.templates))throw new Error(`[ct.templates] An attempt to create a copy of a non-existent template \`${t}\` detected. A typo?`);const s=Rt.templates[t];if(!(s.baseClass in Et))throw new Error(`[internal -> makeCopy] Unknown base class \`${s.baseClass}\` for template \`${t}\`.`);const r=new Et[s.baseClass](s,n);return((t,e,i,o,n,s)=>{const r=At,a=Object.getOwnPropertyNames(r);for(const e in a)"constructor"!==a[e]&&Object.defineProperty(t,a[e],Object.getOwnPropertyDescriptor(r,a[e]));Xt.apply(t,[e,i,o,n,s])})(r,e,i,s,o,n),r},Lt=function(){this.$chashes=fe.getHashes(this);for(const t of this.$chashes)t in fe.grid?fe.grid[t].push(this):fe.grid[t]=[this]},Rt={CopyProto:At,Background:G,Tilemap:Z,list:{BACKGROUND:[],TILEMAP:[]},templates:{},copyIntoRoom(t,e=0,i=0,o,n={}){if(!(o&&o instanceof zt))throw new Error(`Attempt to spawn a copy of template ${t} inside an invalid room. Room's value provided: ${o}`);const s=Nt(t,e,i,o,n);return o.addChild(s),me.push(s),s},copy:(t,e=0,i=0,o={})=>Rt.copyIntoRoom(t,e,i,Ht.current,o),each(t){for(const e of me)e instanceof Xt&&t.apply(e,this)},withCopy(t,e){e.apply(t,this)},withTemplate(t,e){for(const i of Rt.list[t])e.apply(i,this)},exists(t){if(!(t in Rt.templates))throw new Error(`[ct.templates] templates.exists: There is no such template ${t}.`);return Rt.list[t].length>0},isCopy:t=>t&&t[ae],valid:t=>"object"==typeof t&&(ae in t?!t.kill:t instanceof PIXI.DisplayObject&&Boolean(t.position)),beforeStep(){},afterStep(){this.behaviors.length&&it(this,"templates","thisOnStep")},beforeDraw(){!1},afterDraw(){if(this.behaviors.length&&it(this,"templates","thisOnDraw"),"Button"!==this.baseClass||1===this.scale.x&&1===this.scale.y||this.unsize(),this.updateNineSliceShape&&(this.prevWidth===this.width&&this.prevHeight===this.height||(this.prevWidth=this.width,this.prevHeight=this.height,jt.reshapeNinePatch(this))),this.transform&&this.transform._localID!==this.transform._currentLocalID||this.x!==this.xprev||this.y!==this.yprev){delete this._shape;const t=this.$chashes||[];this.$chashes=fe.getHashes(this);for(const e of t)-1===this.$chashes.indexOf(e)&&fe.grid[e].splice(fe.grid[e].indexOf(this),1);for(const e of this.$chashes)-1===t.indexOf(e)&&(e in fe.grid?fe.grid[e].push(this):fe.grid[e]=[this])}},onDestroy(){if(this.$chashes)for(const t of this.$chashes)fe.grid[t].splice(fe.grid[t].indexOf(this),1);this.behaviors.length&&it(this,"templates","thisOnDestroy")}},_t=Rt,Yt=class extends PIXI.DisplayObject{constructor(t,e,i,o){super(),m(this,It,void 0),m(this,Pt,void 0),this.sortDirty=!1,this.reset(t,e,i,o),this.getBounds=this.getBoundingBox}reset(t,e,i,o){this.followX=this.followY=!0,this.follow=void 0,this.targetX=this.x=t,this.targetY=this.y=e,this.z=500,f(this,It,i||1920),f(this,Pt,o||1080),this.referenceLength=Math.max(p(this,It),p(this,Pt))/2,this.shiftX=this.shiftY=this.interpolatedShiftX=this.interpolatedShiftY=0,this.borderX=this.borderY=null,this.minX=this.maxX=this.minY=this.maxY=void 0,this.drift=0,this.shake=0,this.shakeDecay=5,this.shakeX=this.shakeY=1,this.shakeFrequency=50,this.shakePhase=this.shakePhaseX=this.shakePhaseY=0,this.shakeMax=10}get width(){return p(this,It)}set width(t){f(this,It,t)}get height(){return p(this,Pt)}set height(t){f(this,Pt,t)}get scale(){return this.transform.scale}set scale(t){"number"==typeof t?this.transform.scale.x=this.transform.scale.y=t:this.transform.scale.copyFrom(t)}render(){}removeChild(){}calculateBounds(){}moveTo(t,e){this.targetX=t,this.targetY=e}teleportTo(t,e){this.targetX=this.x=t,this.targetY=this.y=e,this.shakePhase=this.shakePhaseX=this.shakePhaseY=0,this.interpolatedShiftX=this.shiftX,this.interpolatedShiftY=this.shiftY}update(t){!function(t,e){t.shake-=e*t.shakeDecay,t.shake=Math.max(0,t.shake),t.shakeMax&&(t.shake=Math.min(t.shake,t.shakeMax));const i=e*t.shakeFrequency;t.shakePhase+=i,t.shakePhaseX+=i*(1+.25*Math.sin(.1489*t.shakePhase)),t.shakePhaseY+=i*(1+.25*Math.sin(.1734*t.shakePhase))}(this,t),this.follow&&ae in this.follow&&this.follow.kill&&(this.follow=!1),!this.follow&&Ht.current.follow&&([this.follow]=_t.list[Ht.current.follow]),this.follow&&"x"in this.follow&&"y"in this.follow&&function(t){const e=null===t.borderX?t.width/2:Math.min(t.borderX,t.width/2),i=null===t.borderY?t.height/2:Math.min(t.borderY,t.height/2),o=t.uiToGameCoord(e,i),n=t.uiToGameCoord(t.width-e,t.height-i);t.follow&&(t.followX&&(t.follow.x<o.x-t.interpolatedShiftX?t.targetX=t.follow.x-e+t.width/2:t.follow.x>n.x-t.interpolatedShiftX&&(t.targetX=t.follow.x+e-t.width/2)),t.followY&&(t.follow.y<o.y-t.interpolatedShiftY?t.targetY=t.follow.y-i+t.height/2:t.follow.y>n.y-t.interpolatedShiftY&&(t.targetY=t.follow.y+i-t.height/2)))}(this);const e=this.drift?Math.min(1,(1-this.drift)*t*60):1;this.x=this.targetX*e+this.x*(1-e),this.y=this.targetY*e+this.y*(1-e),this.interpolatedShiftX=this.shiftX*e+this.interpolatedShiftX*(1-e),this.interpolatedShiftY=this.shiftY*e+this.interpolatedShiftY*(1-e),function(t){if(void 0!==t.minX){const e=t.minX+t.width*t.scale.x*.5;t.x=Math.max(e,t.x),t.targetX=Math.max(e,t.targetX)}if(void 0!==t.maxX){const e=t.maxX-t.width*t.scale.x*.5;t.x=Math.min(e,t.x),t.targetX=Math.min(e,t.targetX)}if(void 0!==t.minY){const e=t.minY+t.height*t.scale.y*.5;t.y=Math.max(e,t.y),t.targetY=Math.max(e,t.targetY)}if(void 0!==t.maxY){const e=t.maxY-t.height*t.scale.y*.5;t.y=Math.min(e,t.y),t.targetY=Math.min(e,t.targetY)}}(this),this.x=this.x||0,this.y=this.y||0;const{listener:i}=PIXI.sound.context.audioContext;"positionX"in i?(i.positionX.value=this.x/this.referenceLength,i.positionY.value=this.y/this.referenceLength,i.positionZ.value=this.scale.x):i.setPosition(this.x/this.referenceLength,this.y/this.referenceLength,this.scale.x),T.forEach(((t,e)=>t.reposition(e)))}get computedX(){const t=(Math.sin(this.shakePhaseX)+.25*Math.sin(3.1846*this.shakePhaseX))/1.25;return this.x+t*this.shake*Math.max(this.width,this.height)/100*this.shakeX+this.interpolatedShiftX}get computedY(){const t=(Math.sin(this.shakePhaseY)+.25*Math.sin(2.8948*this.shakePhaseY))/1.25;return this.y+t*this.shake*Math.max(this.width,this.height)/100*this.shakeY+this.interpolatedShiftY}get left(){return this.computedX-this.width/2*this.scale.x}get top(){return this.computedY-this.height/2*this.scale.y}get right(){return this.computedX+this.width/2*this.scale.x}get bottom(){return this.computedY+this.height/2*this.scale.y}uiToGameCoord(t,e){const i=(t-this.width/2)*this.scale.x,o=(e-this.height/2)*this.scale.y,n=jt.rotate(i,o,this.angle);return new PIXI.Point(n.x+this.computedX,n.y+this.computedY)}gameToUiCoord(t,e){const i=t-this.computedX,o=e-this.computedY,n=jt.rotate(i,o,-this.angle);return new PIXI.Point(n.x/this.scale.x+this.width/2,n.y/this.scale.y+this.height/2)}getTopLeftCorner(){return this.uiToGameCoord(0,0)}getTopRightCorner(){return this.uiToGameCoord(this.width,0)}getBottomLeftCorner(){return this.uiToGameCoord(0,this.height)}getBottomRightCorner(){return this.uiToGameCoord(this.width,this.height)}getBoundingBox(){const t=new PIXI.Bounds,e=this.getTopLeftCorner(),i=this.getTopRightCorner(),o=this.getBottomLeftCorner(),n=this.getBottomRightCorner();return t.addPoint(new PIXI.Point(e.x,e.y)),t.addPoint(new PIXI.Point(i.x,i.y)),t.addPoint(new PIXI.Point(o.x,o.y)),t.addPoint(new PIXI.Point(n.x,n.y)),t.getRectangle()}contains(t){const e=t.getBounds(!0);return e.right>0&&e.left<this.width*this.scale.x&&e.bottom>0&&e.top<this.width*this.scale.y}realign(t){if(!t.isUi)throw console.error("[ct.camera] An attempt to realing a room that is not in UI space. The room in question is",t),new Error("[ct.camera] An attempt to realing a room that is not in UI space.");const e=Ht.templates[t.name].width||1,i=Ht.templates[t.name].height||1;for(const o of t.children)ae in o&&(o.skipRealign||(o.x=o.xstart/e*this.width,o.y=o.ystart/i*this.height))}manageStage(){const t=this.computedX,e=this.computedY,i=1/(isNaN(this.scale.x)?1:this.scale.x),o=1/(isNaN(this.scale.y)?1:this.scale.y);for(const n of le.stage.children)"isUi"in n&&n.isUi||!n.pivot||(n.x=-this.width/2,n.y=-this.height/2,n.pivot.x=t,n.pivot.y=e,n.scale.x=i,n.scale.y=o,n.angle=-this.angle)}};It=new WeakMap,Pt=new WeakMap;var Bt=new Yt(0,0,1280,720),Kt=function(t,e){let i="The parameter ";throw t&&(i+=`${t} `),e&&(i+=`of ${e} `),i+="is required.",new Error(i)},Ft={delta:1,deltaUi:1,time:1/60,timeUi:1/60,timeUI:1/60,getEnvironment(){if("ct.js debugger"===window.name)return"ct.ide";try{if("nw"in window&&"require"in window.nw)return"nw"}catch(t){}try{return c("electron"),"electron"}catch(t){}return"browser"},getOS(){const t=window.navigator.userAgent;return-1!==t.indexOf("Windows")?"windows":-1!==t.indexOf("Linux")?"linux":-1!==t.indexOf("Mac")?"darwin":"unknown"},ldx:(t,e)=>t*Math.cos(e*Math.PI/180),ldy:(t,e)=>t*Math.sin(e*Math.PI/180),pdn:(t,e,i,o)=>(180*Math.atan2(o-e,i-t)/Math.PI+360)%360,pdc:(t,e,i,o)=>Math.sqrt((i-t)*(i-t)+(o-e)*(o-e)),degToRad:t=>t*Math.PI/180,radToDeg:t=>t/Math.PI*180,rotate:(t,e,i)=>Ft.rotateRad(t,e,Ft.degToRad(i)),rotateRad(t,e,i){const o=Math.sin(i),n=Math.cos(i);return new PIXI.Point(n*t-o*e,n*e+o*t)},deltaDir(t,e){var i=(e=(e%360+360)%360)-(t=(t%360+360)%360);return i>180&&(i-=360),i<-180&&(i+=360),i},clamp:(t,e,i)=>Math.max(t,Math.min(i,e)),lerp:(t,e,i)=>t+(e-t)*i,unlerp:(t,e,i)=>(i-t)/(e-t),map:(t,e,i,o,n)=>(t-e)*(n-o)/(i-e)+o,hexToPixi:t=>Number("0x"+t.slice(1)),pixiToHex:t=>"#"+t.toString(16).padStart(6,"0"),getRectShape:t=>({type:"rect",left:t.width*t.anchor.x,top:t.height*t.anchor.y,right:t.width*(1-t.anchor.x),bottom:t.height*(1-t.anchor.y)}),reshapeNinePatch(t){const e="NineSlicePlane"===t.baseClass?t:t.panel,i=e.texture,o=i.shape,n=i.width,s=i.height,r=e.width-n,a=e.height-s,l=n-e.leftWidth-e.rightWidth,h=s-e.topHeight-e.bottomHeight;if("circle"===o.type)throw new Error(`[u.reshapeNinePatch] Cannot reshape a circular collision mask for ${t.template}. Please use a different collision type for its texture.`);if("rect"===o.type){const i={type:"rect",left:o.left,top:o.top,right:o.right+r,bottom:o.bottom+a};return o.left>e.leftWidth&&(i.left=(o.left-e.leftWidth)*(1+r)/l),o.right<e.rightWidth&&(i.right=(o.right-e.rightWidth)*(1+r)/l),o.top>e.topHeight&&(i.top=(o.top-e.topHeight)*(1+a)/h),o.bottom<e.bottomHeight&&(i.bottom=(o.bottom-e.bottomHeight)*(1+a)/h),void(t.shape=i)}if("strip"===o.type){const i={type:"strip",points:[],closedStrip:o.closedStrip};i.points=o.points.map((t=>{let{x:i,y:o}=t;return t.x>=n-e.rightWidth?i+=r:t.x>e.leftWidth&&(i=e.leftWidth+(t.x-e.leftWidth)*(1+r/l)),t.y>=s-e.bottomHeight?o+=a:t.y>e.topHeight&&(o=e.topHeight+(t.y-e.topHeight)*(1+a/h)),{x:i,y:o}})),t.shape=i}const c=Ft.getHitArea(t.shape);c&&(t.hitArea=c)},getHitArea:t=>"circle"===t.type?new PIXI.Circle(0,0,t.r):"rect"===t.type?new PIXI.Rectangle(-t.left,-t.top,t.left+t.right,t.top+t.bottom):"strip"===t.type&&new PIXI.Polygon(t.points.map((t=>new PIXI.Point(t.x,t.y)))),prect(t,e,i){var o,n,s,r;if(i instanceof Array)o=Math.min(i[0],i[2]),n=Math.max(i[0],i[2]),s=Math.min(i[1],i[3]),r=Math.max(i[1],i[3]);else{if("rect"!==i.shape.type)throw new Error("[ct.u.prect] The specified copy doesn't have a rectangular collision shape.");o=i.x-i.shape.left*i.scale.x,n=i.x+i.shape.right*i.scale.x,s=i.y-i.shape.top*i.scale.y,r=i.y+i.shape.bottom*i.scale.y}return t>=o&&e>=s&&t<=n&&e<=r},pcircle(t,e,i){if(i instanceof Array)return Ft.pdc(t,e,i[0],i[1])<i[2];if("circle"!==i.shape.type)throw new Error("[ct.u.pcircle] The specified copy doesn't have a circular shape");return Ft.pdc(0,0,(i.x-t)/i.scale.x,(i.y-e)/i.scale.y)<i.shape.r},uiToCssCoord(t,e){const i=qt;return new PIXI.Point(t/Bt.width*i.width+i.x,e/Bt.height*i.height+i.y)},gameToCssCoord(t,e){const i=Bt.gameToUiCoord(t,e);return Ft.uiToCssCoord(i.x,i.y)},uiToCssScalar:t=>t/Bt.width*qt.width,gameToCssScalar:t=>t/(Bt.width*Bt.scale.x)*qt.width,gameToUiCoord:(t,e)=>Bt.gameToUiCoord(t,e),uiToGameCoord:(t,e)=>Bt.uiToGameCoord(t,e),wait:t=>P.add(t),waitUi:t=>P.addUi(t),promisify:t=>function(...e){return new Promise(((i,o)=>{e.push((function(t,e){t?o(t):i(e)})),t.call(this,...e)}))},required:Kt,numberedString:(t,e)=>t+"_"+e.toString().padStart(2,"0"),getStringNumber:t=>Number(t.split("_").pop())};Object.assign(Ft,{getOs:Ft.getOS,lengthDirX:Ft.ldx,lengthDirY:Ft.ldy,pointDirection:Ft.pdn,pointDistance:Ft.pdc,pointRectangle:Ft.prect,pointCircle:Ft.pcircle});var Ut,jt=Ft,$t=class extends PIXI.Container{constructor(t,e){if(super(),this.alignElements=[],this.kill=!1,this.tileLayers=[],this.backgrounds=[],this.bindings=new Set,this.tickerSet=new Set,this.timer1=0,this.timer2=0,this.timer3=0,this.timer4=0,this.timer5=0,this.timer6=0,this.x=this.y=0,this.sortableChildren=!0,this.uid=$t.getNewId(),t){this.onCreate=t.onCreate,this.onStep=t.onStep,this.onDraw=t.onDraw,this.onLeave=t.onLeave,this.template=t,this.name=t.name,this.isUi=t.isUi,this.follow=t.follow,this.viewWidth=t.width,this.viewHeight=t.height,this.behaviors=[...t.behaviors],t.extends&&Object.assign(this,t.extends),e&&(Wt.current=this,le.renderer.background.color=jt.hexToPixi(this.template.backgroundColor)),this===rooms.current&&(fe.tileGrid={});for(let e=0,i=t.bgs.length;e<i;e++){const i=new G(t.bgs[e].texture,null,t.bgs[e].depth,t.bgs[e].exts);this.addChild(i)}for(let e=0,i=t.tiles.length;e<i;e++){const i=new Z(t.tiles[e]);this.tileLayers.push(i),this.addChild(i)}for(let e=0,i=t.objects.length;e<i;e++){const i=t.objects[e],o=i.exts||{},n=i.customProperties||{},s=_t.copyIntoRoom(i.template,i.x,i.y,this,h(l(l({},o),n),{scaleX:i.scale.x,scaleY:i.scale.y,rotation:i.rotation,alpha:i.opacity,tint:i.tint,customSize:i.customSize,customWordWrap:i.customWordWrap,customText:i.customText,customAnchor:i.customAnchor,align:i.align}));i.align&&this.alignElements.push(s),t.bindings[e]&&this.bindings.add(t.bindings[e].bind(s))}this.alignElements.length&&this.realignElements(t.width,t.height,Bt.width,Bt.height)}else this.behaviors=[];return this}static getNewId(){return this.roomId++,this.roomId}realignElements(t,e,i,o){for(const n of this.alignElements){if(!n.align)continue;const{padding:s,frame:r}=n.align,a=t*r.x1/100+s.left,l=e*r.y1/100+s.top,h=t*(r.x2-r.x1)/100-s.left-s.right,c=e*(r.y2-r.y1)/100-s.top-s.bottom,d=i*r.x1/100+s.left,u=o*r.y1/100+s.top,p=i*(r.x2-r.x1)/100-s.left-s.right,m=o*(r.y2-r.y1)/100-s.top-s.bottom;if(t!==i)switch(n.align.alignX){case"start":n.x+=d-a;break;case"both":n.x+=d-a,n.width+=p-h;break;case"end":n.x+=p-h+d-a;break;case"center":n.x+=(p-h)/2+d-a;break;case"scale":{const t=p/h||1;n.width*=t,n.x=(n.x-a)*t+d}}if(e!==o)switch(n.align.alignY){case"start":n.y+=u-l;break;case"both":n.y+=u-l,n.height+=m-c;break;case"end":n.y+=m-c+u-l;break;case"center":n.y+=(m-c)/2+u-l;break;case"scale":{const t=m/c||1;n.height*=t,n.y=(n.y-l)*t+u}}}}get x(){return-this.position.x}set x(t){this.position.x=-t}get y(){return-this.position.y}set y(t){this.position.y=-t}},zt=$t;zt.roomId=0,zt.roomId=0;var Wt={templates:{},Room:zt,current:null,list:{},addBg(t,e){const i=new G(t,null,e);return Wt.current.addChild(i),i},clear(){le.stage.children.length=0,me.length=0;for(const t in _t.list)_t.list[t]=[];for(const t in J.list)J.list[t]=[];Wt.list={};for(const t in Wt.templates)Wt.list[t]=[]},remove(t){if(!(t instanceof zt)){if("string"==typeof t)throw console.error("[rooms.remove] To remove a room, you should provide a reference to it (to an object), not its name. Provided value:",t),new Error("[rooms.remove] Invalid argument type");throw new Error("[rooms] An attempt to remove a room that is not actually a room! Provided value:"+t)}const e=Wt.list[t.name].indexOf(t);-1!==e?Wt.list[t.name].splice(e,1):console.warn("[rooms] Removing a room that was not found in rooms.list. This is strange…"),t.kill=!0,le.stage.removeChild(t);for(const e of t.children)ae in e&&(e.kill=!0);t.onLeave(),Wt.onLeave.apply(t)},switch(t){Wt.templates[t]?(Ut=t,Wt.switching=!0):console.error('[rooms] The room "'+t+'" does not exist!')},switching:!1,restart(){Wt.switch(Wt.current.name)},append(t,e){if(!(t in Wt.templates))throw new Error(`[rooms.append] append failed: the room ${t} does not exist!`);const i=new zt(Wt.templates[t],!1);return e&&Object.assign(i,e),le.stage.addChild(i),i.onCreate.apply(i),Wt.onCreate.apply(i),Wt.list[t].push(i),i},prepend(t,e){if(!(t in Wt.templates))throw new Error(`[rooms] prepend failed: the room ${t} does not exist!`);const i=new zt(Wt.templates[t],!1);return e&&Object.assign(i,e),le.stage.addChildAt(i,0),i.onCreate.apply(i),Wt.onCreate.apply(i),Wt.list[t].push(i),i},merge(t){var e,i;if(!(t in Wt.templates))return console.error(`[rooms] merge failed: the room ${t} does not exist!`),!1;const o={copies:[],tileLayers:[],backgrounds:[]},n=Wt.templates[t],s=Wt.current;for(const t of n.bgs){const e=new G(t.texture,null,t.depth,t.exts);s.backgrounds.push(e),s.addChild(e),o.backgrounds.push(e)}for(const t of n.tiles){const e=new Z(t);s.tileLayers.push(e),s.addChild(e),o.tileLayers.push(e)}for(const t of n.objects){const n=_t.copyIntoRoom(t.template,t.x,t.y,s,l({tx:t.scale.x||1,ty:t.scale.y||1,tr:t.rotation||0,scaleX:null==(e=t.scale)?void 0:e.x,scaleY:null==(i=t.scale)?void 0:i.y,rotation:t.rotation,alpha:t.opacity},t.customProperties));o.copies.push(n)}return o},forceSwitch(t){Ut&&(t=Ut),Wt.current&&(Wt.rootRoomOnLeave.apply(Wt.current),Wt.current.onLeave(),Wt.onLeave.apply(Wt.current),Wt.current=void 0),Wt.clear(),re.length=0;var e=Wt.templates[t];Bt.reset(e.width/2,e.height/2,e.width,e.height),e.cameraConstraints&&(Bt.minX=e.cameraConstraints.x1,Bt.maxX=e.cameraConstraints.x2,Bt.minY=e.cameraConstraints.y1,Bt.maxY=e.cameraConstraints.y2),Wt.current=new zt(e,!0),le.stage.addChild(Wt.current),Gt(),Wt.rootRoomOnCreate.apply(Wt.current),Wt.current.onCreate(),Wt.onCreate.apply(Wt.current),Wt.list[t].push(Wt.current),Bt.manageStage(),Wt.switching=!1,Ut=void 0},onCreate(){if(this===rooms.current){const t=new PIXI.Graphics;t.depth=1e7,rooms.current.addChild(t),fe.debugTraceGraphics=t}for(const t of this.tileLayers)-1!==this.children.indexOf(t)&&fe.enableTilemapCollisions(t);this.behaviors.length&&it(this,"rooms","thisOnCreate")},onLeave(){if(!this.kill){for(const t of tween.tweens)t.reject({info:"Room switch",code:1,from:"tween"});tween.tweens=[]}this===rooms.current&&(fe.grid={}),this.behaviors.length&&it(this,"rooms","thisOnDestroy")},beforeStep(){ye.updateGestures();{const t=camera.uiToGameCoord(ye.xui,ye.yui);ye.x=t.x,ye.y=t.y}{let t=0;for(;t<tween.tweens.length;){const e=tween.tweens[t];if(e.obj.kill){e.reject({code:2,info:"Copy is killed"}),tween.tweens.splice(t,1);continue}let i=1e3*e.timer.time/e.duration;i>1&&(i=1);for(const t in e.fields){const o=e.starting[t],n=e.fields[t]-e.starting[t];e.obj[t]=e.curve(o,n,i)}1!==i?t++:(e.resolve(e.fields),tween.tweens.splice(t,1))}}},afterStep(){this.behaviors.length&&it(this,"rooms","thisOnStep");for(const t of this.tickerSet)t.tick()},beforeDraw(){},afterDraw(){for(const t of ye.down)t.xprev=t.x,t.yprev=t.y,t.xuiprev=t.x,t.yuiprev=t.y;for(const t of ye.hover)t.xprev=t.x,t.yprev=t.y,t.xuiprev=t.x,t.yuiprev=t.y;inputs.registry["pointer.Wheel"]=0,ye.clearReleased(),ye.xmovement=ye.ymovement=0,ge.clear(),this.behaviors.length&&it(this,"rooms","thisOnDraw");for(const t of this.bindings)t()},rootRoomOnCreate(){},rootRoomOnStep(){},rootRoomOnDraw(){},rootRoomOnLeave(){},starting:"mainMenu"},Ht=Wt;document.body.style.overflow="hidden";var qt={x:0,y:0,width:0,height:0},Gt=()=>{const t=pe.viewMode;let e=pe.highDensity&&window.devicePixelRatio||1;"fastScale"!==t&&"fastScaleInteger"!==t||(e=1);const i=window.innerWidth/Ht.current.viewWidth,o=window.innerHeight/Ht.current.viewHeight;let n=Math.min(i,o);var s,r,a,l;if("fastScaleInteger"===t&&(n=n<1?n:Math.floor(n)),"expand"===t?(s=Math.ceil(window.innerWidth*e),r=Math.ceil(window.innerHeight*e),a=window.innerWidth,l=window.innerHeight):"scaleFit"===t||"scaleFill"===t?"scaleFill"===t?(s=Math.ceil(Ht.current.viewWidth*i*e),r=Math.ceil(Ht.current.viewHeight*o*e),a=window.innerWidth/n,l=window.innerHeight/n):(s=Math.ceil(Ht.current.viewWidth*n*e),r=Math.ceil(Ht.current.viewHeight*n*e),a=Ht.current.viewWidth,l=Ht.current.viewHeight):(a=s=Ht.current.viewWidth,l=r=Ht.current.viewHeight),le.renderer.resize(s,r),le.stage.scale.x=le.stage.scale.y="scaleFill"!==t&&"scaleFit"!==t?"fastScale"===t||"fastScaleInteger"===t?1:e:e*n,le.view.style.width=Math.ceil(s/e)+"px",le.view.style.height=Math.ceil(r/e)+"px",Bt){const t=Bt.width,e=Bt.height;Bt.width=a,Bt.height=l;for(const i of le.stage.children)i instanceof zt&&i.realignElements(t,e,a,l)}!function(t,e){const i=le.view;"fastScale"===t||"fastScaleInteger"===t?(i.style.transform=`translate(-50%, -50%) scale(${e})`,i.style.position="absolute",i.style.top="50%",i.style.left="50%"):"expand"===t||"scaleFill"===t?(i.style.transform="",i.style.position="static",i.style.top="unset",i.style.left="unset"):"scaleFit"===t?(i.style.transform="translate(-50%, -50%)",i.style.position="absolute",i.style.top="50%",i.style.left="50%"):i.style.transform=i.style.position=i.style.top=i.style.left="";const o=i.getBoundingClientRect();qt.x=o.left,qt.y=o.top,qt.width=o.width,qt.height=o.height}(t,n)};window.addEventListener("resize",Gt);var Jt=function(){try{return c("electron").remote.BrowserWindow.getFocusedWindow.isFullScreen}catch(t){}return Boolean(document.fullscreenElement)},Vt={},Qt=class{constructor(t){return this.methodCodes=[],this.methodMultipliers=[],this.prevValue=0,this.value=0,this.name=t,this}methodExists(t){return-1!==this.methodCodes.indexOf(t)}addMethod(t,e){if(-1!==this.methodCodes.indexOf(t))throw new Error(`[ct.inputs] An attempt to add an already added input "${t}" to an action "${this.name}".`);this.methodCodes.push(t),this.methodMultipliers.push(void 0!==e?e:1)}removeMethod(t){const e=this.methodCodes.indexOf(t);-1!==e&&(this.methodCodes.splice(e,1),this.methodMultipliers.splice(e,1))}setMultiplier(t,e){const i=this.methodCodes.indexOf(t);-1!==i?this.methodMultipliers[i]=e:(console.warn(`[ct.inputs] An attempt to change multiplier of a non-existent method "${t}" at event ${this.name}`),console.trace())}update(){this.prevValue=this.value,this.value=0;for(let t=0,e=this.methodCodes.length;t<e;t++){const e=Vt[this.methodCodes[t]]||0;this.value+=e*this.methodMultipliers[t]}return this.value=Math.max(-1,Math.min(this.value,1)),this.value}reset(){this.prevValue=this.value=0}get pressed(){return 0===this.prevValue&&0!==this.value}get released(){return 0!==this.prevValue&&0===this.value}get down(){return 0!==this.value}},Zt={},te={registry:Vt,addAction(t,e){if(t in Zt)throw new Error(`[ct.inputs] An action "${t}" already exists, can't add a new one with the same name.`);const i=new Qt(t);for(const t of e)i.addMethod(t.code,t.multiplier);return Zt[t]=i,i},removeAction(t){delete Zt[t]},updateActions(){for(const t in Zt)Zt[t].update()}},ee=JSON.parse("{}");PIXI.particles.Particle.prototype.isInteractive=()=>!1;{const t=(t,e)=>{let i;return e||(e={}),"#"===t.charAt(0)?t=t.substr(1):0===t.indexOf("0x")&&(t=t.substr(2)),8===t.length&&(i=t.substr(0,2),t=t.substr(2)),e.r=parseInt(t.substr(0,2),16),e.g=parseInt(t.substr(2,2),16),e.b=parseInt(t.substr(4,2),16),i&&(e.a=parseInt(i,16)),e};PIXI.particles.PropertyNode.createList=e=>{const i=e.list;let o;const{value:n,time:s}=i[0],r=o=new PIXI.particles.PropertyNode("string"==typeof n?t(n):n,s,e.ease);if(i.length>1)for(let e=1;e<i.length;++e){const{value:n,time:s}=i[e];o.next=new PIXI.particles.PropertyNode("string"==typeof n?t(n):n,s),o=o.next}return r.isStepped=Boolean(e.isStepped),r}}var ie=class extends PIXI.Container{constructor(t,e){super(),this.frozen=!1,this.stopped=!1,this.kill=!1,this.isUi=!1,this.emitters=[],this.delayed=[];for(const i of t){let{settings:t}=i;if(t=h(l({},t),{behaviors:structuredClone(t.behaviors)}),e.tint){const i=new PIXI.Color(e.tint);t.behaviors[1].config.color.list.forEach((t=>{t.value=new PIXI.Color(t.value).multiply(i).toHex().slice(1)}))}const o=H.getTexture(i.texture);"textureRandom"===i.textureBehavior?t.behaviors.push({type:"textureRandom",config:{textures:o}}):t.behaviors.push({type:"animatedSingle",config:{anim:{framerate:i.animatedSingleFramerate,loop:!0,textures:o}}});const n=new PIXI.particles.Emitter(this,t),s=i.settings.delay+e.prewarmDelay;s>0?(n.emit=!1,this.delayed.push({value:s,emitter:n})):s<0?(n.emit=!0,n.update(-s)):n.emit=!0,n.initialDeltaPos={x:i.settings.pos.x,y:i.settings.pos.y},this.emitters.push(n),n.playOnce((()=>{this.emitters.splice(this.emitters.indexOf(n),1)}))}this.isUi=e.isUi,this.scale.x=e.scale.x,this.scale.y=e.scale.y,e.rotation?this.rotation=e.rotation:e.angle&&(this.angle=e.angle),this.deltaPosition=e.position,this.zIndex=e.depth,this.frozen=!1,this.isUi?ne.uiTandems.push(this):ne.tandems.push(this)}update(){if(this.stopped)for(const t of this.emitters)t.particleCount||this.emitters.splice(this.emitters.indexOf(t),1);if(this.appendant&&this.appendant.destroyed||this.kill||!this.emitters.length)return this.emit("done"),this.isUi?ne.uiTandems.splice(ne.uiTandems.indexOf(this),1):ne.tandems.splice(ne.tandems.indexOf(this),1),void this.destroy();if(this.frozen)return;const t=(this.isUi?PIXI.Ticker.shared.elapsedMS:PIXI.Ticker.shared.deltaMS)/1e3;for(const e of this.delayed)e.value-=t,e.value<=0&&(e.emitter.emit=!0,this.delayed.splice(this.delayed.indexOf(e),1));for(const e of this.emitters)this.delayed.find((t=>t.emitter===e))||e.update(t);this.follow&&this.updateFollow()}stop(){if(this.stopped)console.trace("[emitters] An attempt to stop an already stopped emitter tandem. Continuing…");else{this.stopped=!0;for(const t of this.emitters)t.emit=!1;this.delayed=[]}}pause(){for(const t of this.emitters)0!==t.maxParticles&&(t.oldMaxParticles=t.maxParticles,t.maxParticles=0)}resume(){for(const t of this.emitters)t.maxParticles=t.oldMaxParticles||t.maxParticles}clear(){for(const t of this.emitters)t.cleanup()}updateFollow(){if(!this.follow)return;if("kill"in this.follow&&this.follow.kill||!this.follow.scale)return this.follow=null,void this.stop();const t=jt.rotate(this.deltaPosition.x*this.follow.scale.x,this.deltaPosition.y*this.follow.scale.y,this.follow.angle);for(const e of this.emitters){e.updateOwnerPos(this.follow.x+t.x,this.follow.y+t.y);const i=jt.rotate(e.initialDeltaPos.x*this.follow.scale.x,e.initialDeltaPos.y*this.follow.scale.y,this.follow.angle);e.updateSpawnPos(i.x,i.y)}}},oe={prewarmDelay:0,scale:{x:1,y:1},tint:16777215,alpha:1,position:{x:0,y:0},isUi:!1,depth:1/0},ne={templates:{}||{},uiTandems:[],tandems:[],fire(t,e,i,o){if(!(t in ne.templates))throw new Error(`[emitters] An attempt to create a non-existent emitter ${t}.`);const n=Object.assign({},oe,o),s=new ie(ne.templates[t],n);return s.x=e,s.y=i,n.room?(n.room.addChild(s),s.isUi=n.room.isUi):(Ht.current.addChild(s),s.isUi=Ht.current.isUi),s},append(t,e,i){if(!(e in ne.templates))throw new Error(`[emitters] An attempt to create a non-existent emitter ${e}.`);if(!(t instanceof PIXI.Container))throw new Error("[emitters] Cannot attach an emitter as the specified parent cannot have child elements.");const o=Object.assign({},oe,i),n=new ie(ne.templates[e],o);if(o.position&&(n.x=o.position.x,n.y=o.position.y),n.appendant=t,!("addChild"in t))throw console.error(t),new Error("[emitters] An attempt to append an emitter to an entity that doesn't support children.");return t.addChild(n),n},follow(t,e,i){if(!(e in ne.templates))throw new Error(`[emitters] An attempt to create a non-existent emitter ${e}.`);const o=Object.assign({},oe,i),n=new ie(ne.templates[e],o);return n.follow=t,n.updateFollow(),"getRoom"in t?t.getRoom().addChild(n):Ht.current.addChild(n),n}};PIXI.Ticker.shared.add((()=>{for(const t of ne.uiTandems)t.update();for(const t of ne.tandems)t.update()}));var se=ne;
/*! Made with ct.js http://ctjs.rocks/ */
console.log("%c 😺 %c ct.js game editor %c v4.0.2 %c https://ctjs.rocks/ ","background: #446adb; color: #fff; padding: 0.5em 0;","background: #5144db; color: #fff; padding: 0.5em 0;","background: #446adb; color: #fff; padding: 0.5em 0;","background: #5144db; color: #fff; padding: 0.5em 0;");try{c("electron")}catch(t){try{c("electron/main")}catch(t){"file:"===location.protocol&&alert("Your game won't work like this because\nWeb 👏 builds 👏 require 👏 a web 👏 server!\n\nConsider using a desktop build, or upload your web build to itch.io, GameJolt or your own website.\n\nIf you haven't created this game, please contact the developer about this issue.\n\n Also note that ct.js games do not work inside the itch app; you will need to open the game with your browser of choice.")}}"NL_OS"in window&&(Neutralino.init(),Neutralino.events.on("windowClose",(()=>{Neutralino.app.exit()})));var re=[],ae=Symbol("I am a ct.js copy");setInterval((function(){re.length=0}),6e4);var le,he,ce={name:"Chessn't",author:"Josh G & Skye Y",site:"",version:"0.0.1"},de="scaleFit",ue=Boolean(!0),pe={get highDensity(){return ue},set highDensity(t){ue=t,PIXI.settings.RESOLUTION=ue?window.devicePixelRatio:1,Ht.current&&Gt()},get targetFps(){return le.ticker.maxFPS},set targetFps(t){le.ticker.maxFPS=t},get viewMode(){return de},set viewMode(t){de=t,Gt()},get fullscreen(){return Jt()},set fullscreen(t){Jt()!==t&&function(){try{const t=c("electron").remote.BrowserWindow.getFocusedWindow();return void t.setFullScreen(!t.isFullScreen())}catch(t){}const t=document.fullscreenElement,e=document.getElementById("ct");if(t)document.exitFullscreen();else{var i=e.requestFullscreen();i&&i.catch((function(t){console.error("[fittoscreen]",t)}))}}()},get pixelart(){return!0},preventDefault:!0},me=[];{const t={width:1280,height:720,antialias:!1,powerPreference:"high-performance",autoDensity:!1,sharedTicker:!1,backgroundAlpha:1};PIXI.settings.RESOLUTION=1;try{le=new PIXI.Application(t)}catch(e){console.error(e),console.warn("[ct.js] Something bad has just happened. This is usually due to hardware problems. I'll try to fix them now, but if the game still doesn't run, try including a legacy renderer in the project's settings."),PIXI.settings.SPRITE_MAX_TEXTURES=Math.min(PIXI.settings.SPRITE_MAX_TEXTURES,16),le=new PIXI.Application(t)}PIXI.settings.ROUND_PIXELS=!0,le.renderer.options.antialias||(PIXI.settings.SCALE_MODE=PIXI.SCALE_MODES.NEAREST),pe.targetFps=60,document.getElementById("ct").appendChild(le.view)}{const t=e=>{e.kill=!0,_t.isCopy(e)&&e.onDestroy&&(_t.onDestroy.apply(e),e.onDestroy.apply(e));for(const i of e.children)_t.isCopy(i)&&t(i);const i=me.indexOf(e);if(-1!==i&&me.splice(i,1),_t.isCopy(e)&&e.template){const t=_t.list[e.template].indexOf(e);-1!==t&&_t.list[e.template].splice(t,1)}re.push(e)},e=()=>{Bt.update(jt.timeUi),Bt.manageStage()},i=()=>{const{ticker:i}=le;jt.delta=i.deltaMS/(1e3/(pe.targetFps||60)),jt.deltaUi=i.elapsedMS/(1e3/(pe.targetFps||60)),jt.time=i.deltaMS/1e3,jt.timeUi=jt.timeUI=i.elapsedMS/1e3,te.updateActions(),P.updateTimers(),fe.debugTraceGraphics.clear(),Ht.rootRoomOnStep.apply(Ht.current);for(let t=0,e=me.length;t<e;t++)_t.isCopy(me[t])&&_t.beforeStep.apply(me[t]),me[t].onStep.apply(me[t]),_t.isCopy(me[t])&&_t.afterStep.apply(me[t]);for(const t of le.stage.children)t instanceof zt&&(Ht.beforeStep.apply(t),t.onStep.apply(t),Ht.afterStep.apply(t));for(const e of me)e.kill&&!e._destroyed&&(t(e),e.destroy({children:!0}));e();for(let t=0,e=me.length;t<e;t++)_t.isCopy(me[t])&&_t.beforeDraw.apply(me[t]),me[t].onDraw.apply(me[t]),_t.isCopy(me[t])&&_t.afterDraw.apply(me[t]),me[t].xprev=me[t].x,me[t].yprev=me[t].y;for(const t of le.stage.children)t instanceof zt&&(Ht.beforeDraw.apply(t),t.onDraw.apply(t),Ht.afterDraw.apply(t));Ht.rootRoomOnDraw.apply(Ht.current),Ht.switching&&Ht.forceSwitch()};(he=H.loadGame()).then((()=>{setTimeout((()=>{le.ticker.add(i),Ht.forceSwitch(Ht.starting)}),0)}))}window.PIXI=PIXI;{const t=Zt,e=J,i=ot,o=Bt,n=ee,s=se,r=te,a=H,l=Ht,h={},c=_,d=st,u=_t,p=tt,m=P,f=jt;Object.assign(window,{actions:t,backgrounds:e,behaviors:i,Camera:Yt,camera:o,CtAction:Qt,content:n,emitters:s,inputs:r,res:a,rooms:l,scripts:h,sounds:c,styles:d,templates:u,Tilemap:Z,tilemaps:p,timer:m,u:f,meta:ce,settings:pe,pixiApp:le}),he.then((()=>{ye.setupListeners()})),r.addAction("Press",[{code:"pointer.Primary"}]),r.addAction("AltPress",[{code:"pointer.Secondary"},{code:"pointer.Double"}]),r.addAction("Scale",[{code:"pointer.DeltaPinch"},{code:"pointer.Wheel"}]),r.addAction("Up",[{code:"keyboard.ArrowUp"},{code:"keyboard.KeyW"},{code:"gamepad.Up"}]),r.addAction("Down",[{code:"keyboard.KeyS"},{code:"keyboard.ArrowDown"},{code:"gamepad.Down"}]),r.addAction("Left",[{code:"keyboard.KeyA"},{code:"keyboard.ArrowLeft"},{code:"gamepad.Left"}]),r.addAction("Right",[{code:"keyboard.ArrowRight"},{code:"keyboard.KeyD"},{code:"gamepad.Right"}]),r.addAction("Enter/Select",[{code:"keyboard.Enter"},{code:"gamepad.Button1"}]),r.addAction("Back/Cancel",[{code:"keyboard.Escape"},{code:"gamepad.Button2"}]),r.addAction("Pause",[{code:"gamepad.Select"}]),r.addAction("XJoystick",[{code:"gamepad.LStickX"}]),r.addAction("YJoystick",[{code:"gamepad.LStickY"}]),u.templates.logo={name:"logo",depth:0,blendMode:PIXI.BLEND_MODES.NORMAL,visible:!0,baseClass:"AnimatedSprite",texture:"logo",animationFPS:30,playAnimationOnStart:!1,loopAnimation:!0,behaviors:JSON.parse("[]"),onStep:function(){},onDraw:function(){},onDestroy:function(){},onCreate:function(){localStorage.setItem("transitioning","1"),localStorage.setItem("isPaused","0")},extends:{}},u.list.logo=[],u.templates.startButton={name:"startButton",depth:0,blendMode:PIXI.BLEND_MODES.NORMAL,visible:!0,baseClass:"AnimatedSprite",texture:"startButton",animationFPS:30,playAnimationOnStart:!1,loopAnimation:!0,behaviors:JSON.parse("[]"),onStep:function(){},onDraw:function(){"1"===localStorage.getItem("transitioning")&&(localStorage.setItem("isBlackNeeded","0"),be.slideIn(500,"left"),localStorage.setItem("transitioning","0"))},onDestroy:function(){},onCreate:function(){this.eventMode="dynamic",this.on("pointertap",(()=>{be.slideOut(500,"left").then((()=>{localStorage.setItem("transitioning","1"),l.switch("difficultySelect"),localStorage.setItem("transitioning","0")}))}))},extends:{}},u.list.startButton=[],u.templates.buttonRandomDifficulty={name:"buttonRandomDifficulty",depth:0,blendMode:PIXI.BLEND_MODES.NORMAL,visible:!0,baseClass:"AnimatedSprite",texture:"buttonRandomDifficulty",animationFPS:30,playAnimationOnStart:!1,loopAnimation:!0,behaviors:JSON.parse("[]"),onStep:function(){},onDraw:function(){},onDestroy:function(){},onCreate:function(){localStorage.setItem("transitioning","1")},extends:{}},u.list.buttonRandomDifficulty=[],u.templates.blackScreen={name:"blackScreen",depth:0,blendMode:PIXI.BLEND_MODES.NORMAL,visible:!0,baseClass:"AnimatedSprite",texture:"blackScreen",animationFPS:30,playAnimationOnStart:!1,loopAnimation:!0,behaviors:JSON.parse("[]"),onStep:function(){"0"===localStorage.getItem("isBlackNeeded")&&(this.x=-1280,localStorage.setItem("isBlackNeeded","1"))},onDraw:function(){},onDestroy:function(){},onCreate:function(){},extends:{}},u.list.blackScreen=[],u.templates.buttonsexit={name:"buttonsexit",depth:0,blendMode:PIXI.BLEND_MODES.NORMAL,visible:!0,baseClass:"AnimatedSprite",texture:"buttonsexit",animationFPS:30,playAnimationOnStart:!1,loopAnimation:!0,behaviors:JSON.parse("[]"),onStep:function(){this.move()},onDraw:function(){},onDestroy:function(){},onCreate:function(){},extends:{}},u.list.buttonsexit=[],u.templates.buttondiffcultlylock={name:"buttondiffcultlylock",depth:0,blendMode:PIXI.BLEND_MODES.NORMAL,visible:!0,baseClass:"AnimatedSprite",texture:"buttondiffcultlylock",animationFPS:30,playAnimationOnStart:!1,loopAnimation:!0,behaviors:JSON.parse("[]"),onStep:function(){this.move()},onDraw:function(){},onDestroy:function(){},onCreate:function(){},extends:{}},u.list.buttondiffcultlylock=[],u.templates.buttonsoptions={name:"buttonsoptions",depth:0,blendMode:PIXI.BLEND_MODES.NORMAL,visible:!0,baseClass:"AnimatedSprite",texture:"buttonsoptions",animationFPS:30,playAnimationOnStart:!1,loopAnimation:!0,behaviors:JSON.parse("[]"),onStep:function(){this.move()},onDraw:function(){},onDestroy:function(){},onCreate:function(){},extends:{}},u.list.buttonsoptions=[],u.templates.buttonmaincredits={name:"buttonmaincredits",depth:0,blendMode:PIXI.BLEND_MODES.NORMAL,visible:!0,baseClass:"AnimatedSprite",texture:"buttonmaincredits",animationFPS:30,playAnimationOnStart:!1,loopAnimation:!0,behaviors:JSON.parse("[]"),onStep:function(){this.move()},onDraw:function(){},onDestroy:function(){},onCreate:function(){},extends:{}},u.list.buttonmaincredits=[],u.templates.buttoniconlock={name:"buttoniconlock",depth:0,blendMode:PIXI.BLEND_MODES.NORMAL,visible:!0,baseClass:"AnimatedSprite",texture:"buttoniconlock",animationFPS:30,playAnimationOnStart:!1,loopAnimation:!0,behaviors:JSON.parse("[]"),onStep:function(){this.move()},onDraw:function(){},onDestroy:function(){},onCreate:function(){},extends:{}},u.list.buttoniconlock=[],u.templates.buttoniconplay={name:"buttoniconplay",depth:0,blendMode:PIXI.BLEND_MODES.NORMAL,visible:!0,baseClass:"AnimatedSprite",texture:"buttoniconplay",animationFPS:30,playAnimationOnStart:!1,loopAnimation:!0,behaviors:JSON.parse("[]"),onStep:function(){this.move()},onDraw:function(){},onDestroy:function(){},onCreate:function(){},extends:{}},u.list.buttoniconplay=[],u.templates.buttonquit={name:"buttonquit",depth:0,blendMode:PIXI.BLEND_MODES.NORMAL,visible:!0,baseClass:"AnimatedSprite",texture:"buttonquit",animationFPS:30,playAnimationOnStart:!1,loopAnimation:!0,behaviors:JSON.parse("[]"),onStep:function(){},onDraw:function(){"1"===localStorage.getItem("transitioning")&&(localStorage.setItem("isBlackNeeded","0"),be.slideIn(500,"left"),localStorage.setItem("transitioning","0"))},onDestroy:function(){},onCreate:function(){this.eventMode="dynamic",this.on("pointertap",(()=>{be.slideOut(500,"left").then((()=>{localStorage.setItem("transitioning","1"),l.switch("mainMenu"),localStorage.setItem("transitioning","0")}))}))},extends:{}},u.list.buttonquit=[],u.templates.Buttonstart={name:"Buttonstart",depth:0,blendMode:PIXI.BLEND_MODES.NORMAL,visible:!0,baseClass:"AnimatedSprite",texture:"Buttonstart",animationFPS:30,playAnimationOnStart:!1,loopAnimation:!0,behaviors:JSON.parse("[]"),onStep:function(){},onDraw:function(){"1"===localStorage.getItem("transitioning")&&(localStorage.setItem("isBlackNeeded","0"),be.slideIn(500,"left"),localStorage.setItem("transitioning","0"))},onDestroy:function(){},onCreate:function(){this.eventMode="dynamic",this.on("pointertap",(()=>{be.slideOut(500,"left").then((()=>{localStorage.setItem("transitioning","1"),l.switch("gameplay")}))}))},extends:{}},u.list.Buttonstart=[],u.templates.Buttonoptions={name:"Buttonoptions",depth:0,blendMode:PIXI.BLEND_MODES.NORMAL,visible:!0,baseClass:"AnimatedSprite",texture:"Buttonoptions",animationFPS:30,playAnimationOnStart:!1,loopAnimation:!0,behaviors:JSON.parse("[]"),onStep:function(){this.move()},onDraw:function(){},onDestroy:function(){},onCreate:function(){},extends:{}},u.list.Buttonoptions=[],u.templates.Buttonresume={name:"Buttonresume",depth:0,blendMode:PIXI.BLEND_MODES.NORMAL,visible:!0,baseClass:"AnimatedSprite",texture:"Buttonresume",animationFPS:30,playAnimationOnStart:!1,loopAnimation:!0,behaviors:JSON.parse("[]"),onStep:function(){},onDraw:function(){},onDestroy:function(){localStorage.setItem("isPaused","0")},onCreate:function(){this.eventMode="dynamic",this.on("pointertap",(()=>{l.remove(this.getRoom())}))},extends:{}},u.list.Buttonresume=[],u.templates.chessboard={name:"chessboard",depth:0,blendMode:PIXI.BLEND_MODES.NORMAL,visible:!0,baseClass:"AnimatedSprite",texture:"chessboard",animationFPS:30,playAnimationOnStart:!1,loopAnimation:!0,behaviors:JSON.parse("[]"),onStep:function(){},onDraw:function(){"1"===localStorage.getItem("transitioning")&&(localStorage.setItem("isBlackNeeded","0"),be.slideIn(500,"left"),localStorage.setItem("transitioning","0"))},onDestroy:function(){},onCreate:function(){localStorage.setItem("transitioning","1")},extends:{}},u.list.chessboard=[],u.templates.buttoniconpause={name:"buttoniconpause",depth:0,blendMode:PIXI.BLEND_MODES.NORMAL,visible:!0,baseClass:"AnimatedSprite",texture:"buttoniconpause",animationFPS:30,playAnimationOnStart:!1,loopAnimation:!0,behaviors:JSON.parse("[]"),onStep:function(){},onDraw:function(){},onDestroy:function(){},onCreate:function(){this.eventMode="dynamic",this.on("pointertap",(()=>{"0"===localStorage.getItem("isPaused")?(localStorage.setItem("isPaused","1"),l.append("pauseMenu")):"1"===localStorage.getItem("isPaused")&&console.log("already paused idiot")}))},extends:{}},u.list.buttoniconpause=[],u.templates.Creators={name:"Creators",depth:0,blendMode:PIXI.BLEND_MODES.NORMAL,visible:!0,baseClass:"AnimatedSprite",texture:"Creators",animationFPS:30,playAnimationOnStart:!1,loopAnimation:!0,behaviors:JSON.parse("[]"),onStep:function(){this.move()},onDraw:function(){},onDestroy:function(){},onCreate:function(){},extends:{}},u.list.Creators=[],u.templates.Difficulty={name:"Difficulty",depth:0,blendMode:PIXI.BLEND_MODES.NORMAL,visible:!0,baseClass:"AnimatedSprite",texture:"Difficulty",animationFPS:30,playAnimationOnStart:!1,loopAnimation:!0,behaviors:JSON.parse("[]"),onStep:function(){this.move()},onDraw:function(){},onDestroy:function(){},onCreate:function(){},extends:{}},u.list.Difficulty=[],function(){const t=()=>{},e={depth:0,blendMode:PIXI.BLEND_MODES.NORMAL,visible:!0,behaviors:[],extends:{},baseClass:"AnimatedSprite",animationFPS:30,playAnimationOnStart:!1,loopAnimation:!0,texture:-1};u.templates.CTTRANSITION_FADE={...e,name:"CTTRANSITION_FADE",onStep(){},onDraw(){},onDestroy(){l.remove(this.room)},onCreate(){this.tex=-1,this.overlay=new PIXI.Graphics,this.overlay.beginFill(this.color),this.overlay.drawRect(0,0,camera.width+1,camera.height+1),this.overlay.endFill(),this.overlay.alpha=this.in?1:0,this.addChild(this.overlay),this.promise=tween.add({obj:this.overlay,fields:{alpha:this.in?0:1},duration:this.duration,silent:!0,isUi:!0}).then((()=>{this.kill=!0}))}},u.templates.CTTRANSITION_SCALE={...e,name:"CTTRANSITION_SCALE",onStep(){},onDraw(){},onDestroy(){l.remove(this.room)},onCreate(){this.tex=-1,this.overlay=new PIXI.Graphics,this.overlay.beginFill(this.color),this.overlay.drawRect(0,0,camera.width+1,camera.height+1),this.overlay.endFill(),this.overlay.alpha=this.in?1:0,this.addChild(this.overlay);var e=camera.scale.x,i=camera.scale.y,o=this.in?e:e*this.scaling,n=this.in?i:i*this.scaling,s=this.in?e*this.scaling:e,r=this.in?i*this.scaling:i;camera.scale.x=s,camera.scale.y=r,this.promise=tween.add({obj:camera.scale,fields:{x:o,y:n},duration:this.duration,silent:!0}).then((()=>{camera.scale.x=e,camera.scale.y=i,this.kill=!0})),tween.add({obj:this.overlay,fields:{alpha:this.in?0:1},duration:this.duration,silent:!0}).catch(t)}},u.templates.CTTRANSITION_SLIDE={...e,name:"CTTRANSITION_SLIDE",onStep(){},onDraw(){},onDestroy(){l.remove(this.room)},onCreate(){this.tex=-1,this.overlay=new PIXI.Graphics,this.overlay.beginFill(this.color),this.overlay.drawRect(0,0,camera.width+1,camera.height+1),this.overlay.endFill(),"left"===this.endAt||"right"===this.endAt?(this.scale.x=this.in?1:0,this.promise=tween.add({obj:this.scale,fields:{x:this.in?0:1},duration:this.duration,curve:tween.easeOutQuart,silent:!0}).then((()=>{this.kill=!0}))):(this.scale.y=this.in?1:0,this.promise=tween.add({obj:this.scale,fields:{y:this.in?0:1},duration:this.duration,curve:tween.easeOutQuart,silent:!0}).then((()=>{this.kill=!0}))),this.in||"left"!==this.endAt||(this.x=camera.width+1,tween.add({obj:this,fields:{x:0},duration:this.duration,curve:tween.easeOutQuart,silent:!0}).catch(t)),this.in||"top"!==this.endAt||(this.y=camera.height+1,tween.add({obj:this,fields:{y:0},duration:this.duration,curve:tween.easeOutQuart,silent:!0}).catch(t)),this.in&&"right"===this.endAt&&tween.add({obj:this,fields:{x:camera.width+1},duration:this.duration,curve:tween.easeOutQuart,silent:!0}).catch(t),this.in&&"bottom"===this.endAt&&tween.add({obj:this,fields:{y:camera.height+1},duration:this.duration,curve:tween.easeOutQuart,silent:!0}).catch(t),this.addChild(this.overlay)}},u.templates.CTTRANSITION_CIRCLE={...e,name:"CTTRANSITION_CIRCLE",onStep(){},onDraw(){},onDestroy(){l.remove(this.room)},onCreate(){this.tex=-1,this.x=(camera.width+1)/2,this.y=(camera.height+1)/2,this.overlay=new PIXI.Graphics,this.overlay.beginFill(this.color),this.overlay.drawCircle(0,0,f.pdc(0,0,(camera.width+1)/2,(camera.height+1)/2)),this.overlay.endFill(),this.addChild(this.overlay),this.scale.x=this.scale.y=this.in?0:1,this.promise=tween.add({obj:this.scale,fields:{x:this.in?1:0,y:this.in?1:0},duration:this.duration,silent:!0}).then((()=>{this.kill=!0}))}}}(),function(){const t={depth:0,blendMode:PIXI.BLEND_MODES.NORMAL,visible:!0,behaviors:[],extends:{},baseClass:"AnimatedSprite",animationFPS:30,playAnimationOnStart:!1,loopAnimation:!0,texture:-1};u.templates.VKEY={name:"VKEY",...t,onStep:function(){var t=!1,e=!1;ye.hoversUi(this)&&(e=!0,ye.collidesUi(this)&&(t=!0)),t?(this.tex=this.opts.texActive||this.opts.texNormal,r.registry["vkeys."+this.opts.key]=1):(r.registry["vkeys."+this.opts.key]=0,this.tex=e&&this.opts.texHover||this.opts.texNormal)},onDraw:function(){this.x="function"==typeof this.opts.x?this.opts.x():this.opts.x,this.y="function"==typeof this.opts.y?this.opts.y():this.opts.y},onDestroy:function(){},onCreate:function(){this.tex=this.opts.texNormal,this.zIndex=this.opts.depth,this.alpha=this.opts.alpha}},u.templates.VJOYSTICK={name:"VJOYSTICK",...t,onCreate:function(){this.tex=this.opts.tex,this.zIndex=this.opts.depth,this.alpha=this.opts.alpha,this.down=!1,this.trackball=new PIXI.Sprite(a.getTexture(this.opts.trackballTex,0)),this.addChild(this.trackball)},onStep:function(){var t=0,e=0;if(this.trackedPointer&&!ye.down.includes(this.trackedPointer)&&(this.trackedPointer=void 0),!this.trackedPointer){const t=ye.collidesUi(this);ye&&(this.down=!0,this.trackedPointer=t)}this.trackedPointer?(t=this.trackedPointer.xui-this.x,e=this.trackedPointer.yui-this.y):(this.touchId=!1,this.down=!1);var i=this.shape.r||this.shape.right||64;if(this.down){t/=i,e/=i;var o=Math.hypot(t,e);o>1&&(t/=o,e/=o),r.registry["vkeys."+this.opts.key+"X"]=t,r.registry["vkeys."+this.opts.key+"Y"]=e}else r.registry["vkeys."+this.opts.key+"X"]=0,r.registry["vkeys."+this.opts.key+"Y"]=0;this.trackball.x=t*i,this.trackball.y=e*i},onDraw:function(){this.x="function"==typeof this.opts.x?this.opts.x():this.opts.x,this.y="function"==typeof this.opts.y?this.opts.y():this.opts.y},onDestroy:function(){}}}(),l.templates.gameplay={name:"gameplay",width:1280,height:720,behaviors:JSON.parse("[]"),objects:JSON.parse('[{"x":64,"y":64,"opacity":1,"tint":16777215,"scale":{"x":1,"y":1},"rotation":0,"exts":{},"customProperties":{},"template":"buttoniconpause"},{"x":672,"y":360,"opacity":1,"tint":16777215,"scale":{"x":1,"y":1},"rotation":0,"exts":{},"customProperties":{},"template":"chessboard"},{"x":0,"y":0,"opacity":1,"tint":16777215,"scale":{"x":1,"y":1},"rotation":0,"exts":{},"customProperties":{},"template":"blackScreen"}]'),bgs:JSON.parse('[{"texture":"background","depth":0,"exts":{"movementX":0,"movementY":0,"parallaxX":1,"parallaxY":1,"repeat":"repeat","scaleX":1,"scaleY":1,"shiftX":0,"shiftY":0}}]'),tiles:JSON.parse("[]"),backgroundColor:"#000000",onStep(){},onDraw(){},onLeave(){},onCreate(){},isUi:!1,follow:!1,extends:{},bindings:{}},l.templates.mainMenu={name:"mainMenu",width:1280,height:720,behaviors:JSON.parse("[]"),objects:JSON.parse('[{"x":640,"y":192,"opacity":1,"tint":16777215,"scale":{"x":1,"y":1},"rotation":0,"exts":{},"customProperties":{},"template":"logo"},{"x":159.9999996,"y":584.0000001,"opacity":1,"tint":16777215,"scale":{"x":0.62222222,"y":0.62222222},"rotation":0,"exts":{},"customProperties":{},"template":"startButton"},{"x":479.9999996,"y":584.0000001,"opacity":1,"tint":16777215,"scale":{"x":0.62222222,"y":0.62222222},"rotation":0,"exts":{},"customProperties":{},"template":"buttonsoptions"},{"x":1119.9999998,"y":584.0000001,"opacity":1,"tint":16777215,"scale":{"x":0.62222222,"y":0.62222222},"rotation":0,"exts":{},"customProperties":{},"template":"buttonsexit"},{"x":799.9999997,"y":584.0000001,"opacity":1,"tint":16777215,"scale":{"x":0.62222222,"y":0.62222222},"rotation":0,"exts":{},"customProperties":{},"template":"buttonmaincredits"},{"x":0,"y":0,"opacity":1,"tint":16777215,"scale":{"x":1,"y":1},"rotation":0,"exts":{},"customProperties":{},"template":"blackScreen"}]'),bgs:JSON.parse('[{"texture":"background","depth":0,"exts":{"movementX":0,"movementY":0,"parallaxX":1,"parallaxY":1,"repeat":"repeat","scaleX":1,"scaleY":1,"shiftX":0,"shiftY":0}}]'),tiles:JSON.parse("[]"),backgroundColor:"#000000",cameraConstraints:{x1:1280,y1:720,x2:1280,y2:720},onStep(){},onDraw(){},onLeave(){},onCreate(){},isUi:!1,follow:!1,extends:{},bindings:{}},l.templates.difficultySelect={name:"difficultySelect",width:1280,height:720,behaviors:JSON.parse("[]"),objects:JSON.parse('[{"x":224,"y":576,"opacity":1,"tint":16777215,"scale":{"x":1,"y":1},"rotation":0,"exts":{},"customProperties":{},"template":"buttonRandomDifficulty"},{"x":224,"y":480,"opacity":1,"tint":16777215,"scale":{"x":1,"y":1},"rotation":0,"exts":{},"customProperties":{},"template":"buttondiffcultlylock"},{"x":224,"y":384,"opacity":1,"tint":16777215,"scale":{"x":1,"y":1},"rotation":0,"exts":{},"customProperties":{},"template":"buttondiffcultlylock"},{"x":224,"y":288,"opacity":1,"tint":16777215,"scale":{"x":1,"y":1},"rotation":0,"exts":{},"customProperties":{},"template":"buttondiffcultlylock"},{"x":960,"y":576,"opacity":1,"tint":16777215,"scale":{"x":1,"y":1},"rotation":0,"exts":{},"customProperties":{},"template":"buttoniconlock"},{"x":1056,"y":576,"opacity":1,"tint":16777215,"scale":{"x":1,"y":1},"rotation":0,"exts":{},"customProperties":{},"template":"buttoniconlock"},{"x":1152,"y":576,"opacity":1,"tint":16777215,"scale":{"x":1,"y":1},"rotation":0,"exts":{},"customProperties":{},"template":"buttoniconlock"},{"x":960,"y":480,"opacity":1,"tint":16777215,"scale":{"x":1,"y":1},"rotation":0,"exts":{},"customProperties":{},"template":"buttoniconlock"},{"x":1056,"y":480,"opacity":1,"tint":16777215,"scale":{"x":1,"y":1},"rotation":0,"exts":{},"customProperties":{},"template":"buttoniconlock"},{"x":1152,"y":480,"opacity":1,"tint":16777215,"scale":{"x":1,"y":1},"rotation":0,"exts":{},"customProperties":{},"template":"buttoniconlock"},{"x":1152,"y":384,"opacity":1,"tint":16777215,"scale":{"x":1,"y":1},"rotation":0,"exts":{},"customProperties":{},"template":"buttoniconlock"},{"x":1056,"y":384,"opacity":1,"tint":16777215,"scale":{"x":1,"y":1},"rotation":0,"exts":{},"customProperties":{},"template":"buttoniconlock"},{"x":960,"y":384,"opacity":1,"tint":16777215,"scale":{"x":1,"y":1},"rotation":0,"exts":{},"customProperties":{},"template":"buttoniconlock"},{"x":960,"y":288,"opacity":1,"tint":16777215,"scale":{"x":1,"y":1},"rotation":0,"exts":{},"customProperties":{},"template":"buttoniconlock"},{"x":1056,"y":288,"opacity":1,"tint":16777215,"scale":{"x":1,"y":1},"rotation":0,"exts":{},"customProperties":{},"template":"buttoniconlock"},{"x":1152,"y":288,"opacity":1,"tint":16777215,"scale":{"x":1,"y":1},"rotation":0,"exts":{},"customProperties":{},"template":"buttoniconlock"},{"x":640,"y":128,"opacity":1,"tint":16777215,"scale":{"x":1.5,"y":1.5},"rotation":0,"exts":{},"customProperties":{},"template":"Difficulty"},{"x":640,"y":640,"opacity":1,"tint":16777215,"scale":{"x":1,"y":1},"rotation":0,"exts":{},"customProperties":{},"template":"Buttonstart"},{"x":0,"y":0,"opacity":1,"tint":16777215,"scale":{"x":1,"y":1},"rotation":0,"exts":{},"customProperties":{},"template":"blackScreen"}]'),bgs:JSON.parse('[{"texture":"background","depth":0,"exts":{"movementX":0,"movementY":0,"parallaxX":1,"parallaxY":1,"repeat":"repeat","scaleX":1,"scaleY":1,"shiftX":0,"shiftY":0}}]'),tiles:JSON.parse("[]"),backgroundColor:"#000000",onStep(){},onDraw(){},onLeave(){},onCreate(){},isUi:!1,follow:!1,extends:{},bindings:{}},l.templates.pauseMenu={name:"pauseMenu",width:1280,height:720,behaviors:JSON.parse("[]"),objects:JSON.parse('[{"x":640,"y":608,"opacity":1,"tint":16777215,"scale":{"x":1,"y":1},"rotation":0,"exts":{},"customProperties":{},"template":"buttonquit"},{"x":640,"y":480,"opacity":1,"tint":16777215,"scale":{"x":1,"y":1},"rotation":0,"exts":{},"customProperties":{},"template":"Buttonoptions"},{"x":640,"y":352,"opacity":1,"tint":16777215,"scale":{"x":1,"y":1},"rotation":0,"exts":{},"customProperties":{},"template":"Buttonresume"}]'),bgs:JSON.parse('[{"texture":"background","depth":0,"exts":{"movementX":0,"movementY":0,"parallaxX":1,"parallaxY":1,"repeat":"repeat","scaleX":1,"scaleY":1,"shiftX":0,"shiftY":0}}]'),tiles:JSON.parse("[]"),backgroundColor:"#B0B0B0",onStep(){},onDraw(){},onLeave(){},onCreate(){},isUi:!0,follow:!1,extends:{},bindings:{}},l.templates.CTTRANSITIONEMPTYROOM={name:"CTTRANSITIONEMPTYROOM",width:1024,height:1024,objects:[],bgs:[],tiles:[],behaviors:[],onStep(){},onDraw(){},onLeave(){},onCreate(){}}}const fe=function(){var t=function(t){switch(t.shape.type){case"rect":return function(t){const{shape:e}=t,i=new SSCD.Vector(t.x,t.y),o=t instanceof PIXI.NineSlicePlane?1:t.scale.x,n=t instanceof PIXI.NineSlicePlane?1:t.scale.y;if(0===t.angle)return i.x-=o>0?e.left*o:-o*e.right,i.y-=n>0?e.top*n:-e.bottom*n,new SSCD.Rectangle(i,new SSCD.Vector(Math.abs((e.left+e.right)*o),Math.abs((e.bottom+e.top)*n)));const s=u.rotate(-e.left*o,-e.top*n,t.angle),r=u.rotate(-e.left*o,e.bottom*n,t.angle),a=u.rotate(e.right*o,e.bottom*n,t.angle),l=u.rotate(e.right*o,-e.top*n,t.angle);return new SSCD.LineStrip(i,[new SSCD.Vector(s.x,s.y),new SSCD.Vector(r.x,r.y),new SSCD.Vector(a.x,a.y),new SSCD.Vector(l.x,l.y)],!0)}(t);case"circle":return function(t){const{shape:e}=t,i=new SSCD.Vector(t.x,t.y);if(Math.abs(t.scale.x)===Math.abs(t.scale.y))return new SSCD.Circle(i,e.r*Math.abs(t.scale.x));const o=[];for(let i=0;i<16;i++){const n=[u.ldx(e.r*t.scale.x,22.5*i),u.ldy(e.r*t.scale.y,22.5*i)];if(0!==t.angle){const{x:e,y:i}=u.rotate(n[0],n[1],t.angle);o.push(new SSCD.Vector(e,i))}else o.push(new SSCD.Vector(n[0],n[1]))}return new SSCD.LineStrip(i,o,!0)}(t);case"strip":return function(t){const{shape:e}=t,i=new SSCD.Vector(t.x,t.y),o=t instanceof PIXI.NineSlicePlane?1:t.scale.x,n=t instanceof PIXI.NineSlicePlane?1:t.scale.y,s=[];if(0!==t.angle)for(const i of e.points){const{x:e,y:r}=u.rotate(i.x*o,i.y*n,t.angle);s.push(new SSCD.Vector(e,r))}else for(const t of e.points)s.push(new SSCD.Vector(t.x*o,t.y*n));return new SSCD.LineStrip(i,s,Boolean(e.closedStrip))}(t);case"line":return function(t){const{shape:e}=t;if(0!==t.angle){const{x:i,y:o}=u.rotate(e.x1*t.scale.x,e.y1*t.scale.y,t.angle),{x:n,y:s}=u.rotate(e.x2*t.scale.x,e.y2*t.scale.y,t.angle);return new SSCD.Line(new SSCD.Vector(t.x+i,t.y+o),new SSCD.Vector(n-i,s-o))}return new SSCD.Line(new SSCD.Vector(t.x+e.x1*t.scale.x,t.y+e.y1*t.scale.y),new SSCD.Vector((e.x2-e.x1)*t.scale.x,(e.y2-e.y1)*t.scale.y))}(t);default:return new SSCD.Circle(new SSCD.Vector(t.x,t.y),0)}};const e=(t,e,i)=>e.template===i,i=(t,e,i)=>!i||i===e.cgroup,o=function(e,i,o,s,r,a,l){const h=e.x,c=e.y,d=e._shape;let u,p;void 0===i||h===i&&c===o?(u=e.$chashes||n.getHashes(e),e._shape=e._shape||t(e)):(e.x=i,e.y=o,e._shape=t(e),u=n.getHashes(e)),r&&(p=[]);for(const t of u){const i=s[t];if(i)for(const t of i)if(t!==e&&a(e,t,l)&&n.collide(e,t)){if(!r)return h===e.x&&c===e.y||(e.x=h,e.y=c,e._shape=d),t;p.includes(t)||p.push(t)}}return h===e.x&&c===e.y||(e.x=h,e.y=c,e._shape=d),!!r&&p},n={m:1,gridX:1024,gridY:1024,grid:{},tileGrid:{},getHashes(t){var e=[],i=Math.round(t.x/n.gridX),o=Math.round(t.y/n.gridY),s=Math.sign(t.x-n.gridX*i),r=Math.sign(t.y-n.gridY*o);return e.push(`${i}:${o}`),s&&(e.push(`${i+s}:${o}`),r&&e.push(`${i+s}:${o+r}`)),r&&e.push(`${i}:${o+r}`),e},drawDebugGraphic(e){const i=this._shape||t(this),o=this.$cDebugCollision,n=this.transform.localTransform.clone().invert();this.$cDebugCollision.transform.setFromMatrix(n),this.$cDebugCollision.position.set(0,0);let s=65535;if(this instanceof Xt?s=26367:this instanceof PIXI.Sprite&&(s=6684927),this.$cHadCollision&&(s=65280),o.lineStyle(2,s),i instanceof SSCD.Rectangle){const t=i.get_position(),n=i.get_size();o.beginFill(s,.1),e?o.drawRect(t.x,t.y,n.x,n.y):o.drawRect(t.x-this.x,t.y-this.y,n.x,n.y),o.endFill()}else if(i instanceof SSCD.LineStrip)if(e){o.moveTo(i.__points[0].x+this.x,i.__points[0].y+this.y);for(let t=1;t<i.__points.length;t++)o.lineTo(i.__points[t].x+this.x,i.__points[t].y+this.y)}else{o.moveTo(i.__points[0].x,i.__points[0].y);for(let t=1;t<i.__points.length;t++)o.lineTo(i.__points[t].x,i.__points[t].y)}else if(i instanceof SSCD.Circle&&i.get_radius()>0)o.beginFill(s,.1),e?o.drawCircle(this.x,this.y,i.get_radius()):o.drawCircle(0,0,i.get_radius()),o.endFill();else if(i instanceof SSCD.Line)if(e){const t=i.get_p1(),e=i.get_p2();o.moveTo(t.x,t.y).lineTo(e.x,e.y)}else o.moveTo(i.__position.x,i.__position.y).lineTo(i.__position.x+i.__dest.x,i.__position.y+i.__dest.y);else e?o.moveTo(-16+this.x,-16+this.y).lineTo(16+this.x,16+this.y).moveTo(-16+this.x,16+this.y).lineTo(16+this.x,-16+this.y):o.moveTo(-16,-16).lineTo(16,16).moveTo(-16,16).lineTo(16,-16)},collide(e,i){if(e._shape=e._shape||t(e),i._shape=i._shape||t(i),"strip"===e._shape.__type||"strip"===i._shape.__type||"complex"===e._shape.__type||"complex"===i._shape.__type){const t=e._shape.get_aabb(),o=i._shape.get_aabb();if(!t.intersects(o))return!1}return!!SSCD.CollisionManager.test_collision(e._shape,i._shape)},occupied(t,e,s,r){"number"!=typeof s&&(r=e,e=void 0,s=void 0);const a=o(t,e,s,n.grid,!1,i,r);return a||o(t,e,s,n.tileGrid,!1,i,r)},occupiedMultiple(t,e,s,r){"number"!=typeof s&&(r=e,e=void 0,s=void 0);const a=o(t,e,s,n.grid,!0,i,r),l=o(t,e,s,n.tileGrid,!0,i,r);return a.concat(l)},free:(t,e,i,o)=>!n.occupied(t,e,i,o),meet:(t,i,s,r)=>("number"!=typeof s&&(r=i,i=void 0,s=void 0),o(t,i,s,n.grid,!1,e,r)),meetMultiple:(t,i,s,r)=>("number"!=typeof s&&(r=i,i=void 0,s=void 0),o(t,i,s,n.grid,!0,e,r)),copies:(t,e,s,r)=>("number"!=typeof s&&(r=e,e=void 0,s=void 0),o(t,e,s,n.grid,!1,i,r)),copiesMultiple:(t,e,s,r)=>("number"!=typeof s&&(r=e,e=void 0,s=void 0),o(t,e,s,n.grid,!0,i,r)),tiles:(t,e,s,r)=>("number"!=typeof s&&(r=e,e=void 0,s=void 0),o(t,e,s,n.tileGrid,!1,i,r)),tilesMultiple:(t,e,s,r)=>("number"!=typeof s&&(r=e,e=void 0,s=void 0),o(t,e,s,n.tileGrid,!0,i,r)),lastdist:null,nearest(t,e,i){const o=templates.list[i];if(o.length>0){var s=Math.hypot(t-o[0].x,e-o[0].y),r=o[0];for(const i of o)Math.hypot(t-i.x,e-i.y)<s&&(s=Math.hypot(t-i.x,e-i.y),r=i);return n.lastdist=s,r}return!1},furthest(t,e,i){const o=o.list[i];if(o.length>0){var s=Math.hypot(t-o[0].x,e-o[0].y),r=o[0];for(const i of o)Math.hypot(t-i.x,e-i.y)>s&&(s=Math.hypot(t-i.x,e-i.y),r=i);return n.lastdist=s,r}return!1},enableTilemapCollisions(e,i){const o=i||e.cgroup;if(e.addedCollisions)throw new Error("[place] The tilemap already has collisions enabled.");e.cgroup=o;for(const i of e.pixiTiles){i._shape=t(i),i.cgroup=o,i.$chashes=n.getHashes(i);for(const t of i.$chashes)t in n.tileGrid?n.tileGrid[t].push(i):n.tileGrid[t]=[i];i.depth=e.depth}e.addedCollisions=!0},moveAlong(t,e,i,o,s){if(!i)return!1;"number"==typeof o&&(s=o,o=void 0),s=Math.abs(s||1),i<0&&(i*=-1,e+=180);for(var r=Math.cos(e*Math.PI/180)*s,a=Math.sin(e*Math.PI/180)*s;i>0;){i<1&&(r*=i,a*=i);const e=n.occupied(t,t.x+r,t.y+a,o);if(e)return e;t.x+=r,t.y+=a,delete t._shape,i--}return!1},moveByAxes(t,e,i,o,s){if(e===i===0)return!1;"number"==typeof o&&(s=o,o=void 0);const r={x:!1,y:!1};for(s=Math.abs(s||1);Math.abs(e)>s;){const i=n.occupied(t,t.x+Math.sign(e)*s,t.y,o);if(i){r.x=i;break}t.x+=Math.sign(e)*s,e-=Math.sign(e)*s}for(;Math.abs(i)>s;){const e=n.occupied(t,t.x,t.y+Math.sign(i)*s,o);if(e){r.y=e;break}t.y+=Math.sign(i)*s,i-=Math.sign(i)*s}return Math.abs(e)<s&&n.free(t,t.x+e,t.y,o)&&(t.x+=e),Math.abs(i)<s&&n.free(t,t.x,t.y+i,o)&&(t.y+=i),!(!r.x&&!r.y)&&r},go(t,e,i,o,s){if(u.pdc(t.x,t.y,e,i)<o)return void(n.free(t,e,i,s)&&(t.x=e,t.y=i,delete t._shape));var r=u.pdn(t.x,t.y,e,i);let a=t.x+u.ldx(o,r),l=t.y+u.ldy(o,r);if(n.free(t,a,l,s))t.x=a,t.y=l,delete t._shape,t.dir=r;else for(var h=-1;h<=1;h+=2)for(var c=30;c<150;c+=30)if(a=t.x+u.ldx(o,r+c*n.m*h),l=t.y+u.ldy(o,r+c*n.m*h),n.free(t,a,l,s))return t.x=a,t.y=l,delete t._shape,void(t.dir=r+c*n.m*h)},traceCustom(t,e,i,o){const s=[];if(!e)return o?n.occupiedMultiple(t,i):n.occupied(t,i);for(const e of me)if((!i||e.cgroup===i)&&n.collide(t,e)){if(!o)return e;s.push(e)}for(const e of templates.list.TILEMAP)if(e.addedCollisions&&(!i||e.cgroup===i))for(const i of e.pixiTiles)if(n.collide(t,i)){if(!o)return i;s.push(i)}return!!o&&s},traceLine(t,e,i){let o=!1;(Math.abs(t.x1-t.x2)>n.gridX||Math.abs(t.y1-t.y2)>n.gridY)&&(o=!0);const s={x:t.x1,y:t.y1,scale:{x:1,y:1},rotation:0,angle:0,shape:{type:"line",x1:0,y1:0,x2:t.x2-t.x1,y2:t.y2-t.y1}},r=n.traceCustom(s,o,e,i);return i&&r.sort((function(e,i){return u.pdc(t.x1,t.y1,e.x,e.y)-u.pdc(t.x1,t.y1,i.x,i.y)})),r},traceRect(t,e,i){let o=!1;"x1"in(t={...t})&&(t.x=t.x1,t.y=t.y1,t.width=t.x2-t.x1,t.height=t.y2-t.y1),(Math.abs(t.width)>n.gridX||Math.abs(t.height)>n.gridY)&&(o=!0);const s={x:t.x,y:t.y,scale:{x:1,y:1},rotation:0,angle:0,shape:{type:"rect",left:0,top:0,right:t.width,bottom:t.height}};return n.traceCustom(s,o,e,i)},traceCircle(t,e,i){let o=!1;(2*t.radius>n.gridX||2*t.radius>n.gridY)&&(o=!0);const s={x:t.x,y:t.y,scale:{x:1,y:1},rotation:0,angle:0,shape:{type:"circle",r:t.radius}};return n.traceCustom(s,o,e,i)},tracePolyline(t,e,i){const o={x:0,y:0,scale:{x:1,y:1},rotation:0,angle:0,shape:{type:"strip",points:t}};return n.traceCustom(o,!0,e,i)},tracePoint(t,e,i){const o={x:t.x,y:t.y,scale:{x:1,y:1},rotation:0,angle:0,shape:{type:"point"}};return n.traceCustom(o,!1,e,i)}};return n.traceRectange=n.traceRect,setInterval((function(){n.m*=-1}),789),Object.defineProperty(templates.CopyProto,"moveContinuous",{value:function(t,e){return this.gravity&&(this.hspeed+=this.gravity*u.time*Math.cos(this.gravityDir*Math.PI/180),this.vspeed+=this.gravity*u.time*Math.sin(this.gravityDir*Math.PI/180)),n.moveAlong(this,this.direction,this.speed*u.time,t,e)}}),Object.defineProperty(templates.CopyProto,"moveBullet",{value:function(t,e){return this.moveContinuous(t,e)}}),Object.defineProperty(templates.CopyProto,"moveContinuousByAxes",{value:function(t,e){return this.gravity&&(this.hspeed+=this.gravity*u.time*Math.cos(this.gravityDir*Math.PI/180),this.vspeed+=this.gravity*u.time*Math.sin(this.gravityDir*Math.PI/180)),n.moveByAxes(this,this.hspeed*u.time,this.vspeed*u.time,t,e)}}),Object.defineProperty(templates.CopyProto,"moveSmart",{value:function(t,e){return this.moveContinuousByAxes(t,e)}}),Object.defineProperty(templates.Tilemap.prototype,"enableCollisions",{value:function(t){n.enableTilemapCollisions(this,t)}}),window.place=n,n}(),ye=function(){const t="pointer.",e=function(e,i){inputs.registry[t+e]=i},i={Primary:1,Middle:4,Secondary:2,ExtraOne:8,ExtraTwo:16,Eraser:32};var o=0,n=0,s=0,r=0,a=0,l=()=>{e("Any",C.down.length>0?1:0),e("Double",C.down.length>1?1:0),e("Triple",C.down.length>2?1:0)},h=t=>{const e=le.view.getBoundingClientRect(),i=(t.clientX-e.left)/e.width*camera.width,o=(t.clientY-e.top)/e.height*camera.height,n=camera.uiToGameCoord(i,o);return{id:t.pointerId,x:n.x,y:n.y,clientX:t.clientX,clientY:t.clientY,xui:i,yui:o,xprev:n.x,yprev:n.y,buttons:t.buttons,xuiprev:i,yuiprev:o,pressure:t.pressure,tiltX:t.tiltX,tiltY:t.tiltY,twist:t.twist,type:t.pointerType,width:t.width/e.width*camera.width,height:t.height/e.height*camera.height}},c=(t,e)=>{const i=le.view.getBoundingClientRect(),o=(e.clientX-i.left)/i.width*camera.width,n=(e.clientY-i.top)/i.height*camera.height,s=camera.uiToGameCoord(o,n);Object.assign(t,{x:s.x,y:s.y,xui:o,yui:n,clientX:e.clientX,clientY:e.clientY,pressure:e.pressure,buttons:e.buttons,tiltX:e.tiltX,tiltY:e.tiltY,twist:e.twist,width:e.width/i.width*camera.width,height:e.height/i.height*camera.height})},d=function(t){Object.assign(C,{x:t.x,y:t.y,xui:t.xui,yui:t.yui,pressure:t.pressure,buttons:t.buttons,tiltX:t.tiltX,tiltY:t.tiltY,twist:t.twist})},p=function(t){window.focus();const e=h(t);C.hover.push(e),t.isPrimary&&d(e)},m=function(t){const e=C.hover.find((e=>e.id===t.pointerId));e&&(e.invalid=!0,C.hover.splice(C.hover.indexOf(e),1));const i=C.down.findIndex((e=>e.id===t.pointerId));-1!==i&&C.down.splice(i,1)},f=function(t){pe.preventDefault&&t.preventDefault();let e=C.hover.find((e=>e.id===t.pointerId));e||(p(t),e=C.hover.find((e=>e.id===t.pointerId)));const i=C.down.find((e=>e.id===t.pointerId));(e||i)&&(e&&c(e,t),i&&c(i,t),t.isPrimary&&d(e||i))},y=function(t){pe.preventDefault&&t.preventDefault(),C.type=t.pointerType;const e=h(t);C.down.push(e),l(),t.isPrimary&&d(e)},g=function(t){pe.preventDefault&&t.preventDefault();const e=C.down.find((e=>e.id===t.pointerId));e&&C.released.push(e),-1!==C.down.indexOf(e)&&C.down.splice(C.down.indexOf(e),1),l()},v=function(t){e("Wheel",(t.wheelDelta||-t.detail)<0?-1:1),pe.preventDefault&&t.preventDefault()};let x=!1;const w=function(t,e,i,o){if(x)return!1;for(const n of i)if((!e||n.id===e.id)&&fe.collide(t,{x:o?n.xui:n.x,y:o?n.yui:n.y,scale:{x:1,y:1},angle:0,shape:{type:"rect",top:n.height/2,bottom:n.height/2,left:n.width/2,right:n.width/2}}))return n;return!1},b=function(){if(!document.pointerLockElement&&!document.mozPointerLockElement){(document.body.requestPointerLock||document.body.mozRequestPointerLock).apply(document.body)}},S=function(t){const e=le.view.getBoundingClientRect(),i=t.movementX/e.width*camera.width,o=t.movementY/e.height*camera.height;C.xlocked+=i,C.ylocked+=o,C.xmovement=i,C.ymovement=o},C={setupListeners(){document.addEventListener("pointerenter",p,{capture:!0}),document.addEventListener("pointerout",m,{capture:!0}),document.addEventListener("pointerleave",m,{capture:!0}),document.addEventListener("pointerdown",y,{capture:!0}),document.addEventListener("pointerup",g,{capture:!0}),document.addEventListener("pointercancel",g,{capture:!0}),document.addEventListener("pointermove",f,{capture:!0}),document.addEventListener("wheel",v,{passive:!1}),document.addEventListener("DOMMouseScroll",v,{passive:!1}),document.addEventListener("contextmenu",(t=>{pe.preventDefault&&t.preventDefault()}))},hover:[],down:[],released:[],x:0,y:0,xprev:0,yprev:0,xui:0,yui:0,xuiprev:0,yuiprev:0,xlocked:0,ylocked:0,xmovement:0,ymovement:0,pressure:1,buttons:0,tiltX:0,tiltY:0,twist:0,width:1,height:1,type:null,clear(){C.down.length=0,C.hover.length=0,C.clearReleased(),l()},clearReleased(){C.released.length=0},collides(t,e,i){var o=i?C.released:C.down;return w(t,e,o,!1)},collidesUi(t,e,i){var o=i?C.released:C.down;return w(t,e,o,!0)},hovers:(t,e)=>w(t,e,C.hover,!1),hoversUi:(t,e)=>w(t,e,C.hover,!0),isButtonPressed(e,o){return o?(o.buttons&i[e])===e?1:0:Boolean((n=e,inputs.registry[t+n]));var n},updateGestures(){let t=0,l=0;const h=le.view.getBoundingClientRect();for(const e of C.down)t+=(e.clientX-h.left)/h.width,l+=(e.clientY-h.top)/h.height;t/=C.down.length,l/=C.down.length;let c=0,d=r;if(C.down.length>1){const t=[C.down[0],C.down[1]].sort(((t,e)=>t.id-e.id));c=u.pdn(t[0].x,t[0].y,t[1].x,t[1].y),d=u.pdc(t[0].x,t[0].y,t[1].x,t[1].y)}o===C.down.length?(C.down.length>1?(e("DeltaRotation",u.degToRad(u.deltaDir(a,c))),e("DeltaPinch",d/r-1)):(e("DeltaPinch",0),e("DeltaRotation",0)),C.down.length?(e("PanX",t-n),e("PanY",l-s)):(e("PanX",0),e("PanY",0))):(o=C.down.length,e("DeltaPinch",0),e("DeltaRotation",0),e("PanX",0),e("PanY",0)),n=t,s=l,a=c,r=d;for(const t in i){e(t,0);for(const o of C.down)(o.buttons&i[t])===i[t]&&e(t,1)}},lock(){if(x)return;x=!0,C.xlocked=C.xui,C.ylocked=C.yui;(document.body.requestPointerLock||document.body.mozRequestPointerLock).apply(document.body),document.addEventListener("click",b,{capture:!0}),document.addEventListener("pointermove",S,{capture:!0})},unlock(){x&&(x=!1,(document.pointerLockElement||document.mozPointerLockElement)&&(document.exitPointerLock||document.mozExitPointerLock)(),document.removeEventListener("click",b),document.removeEventListener("pointermove",S))},get locked(){return Boolean(document.pointerLockElement||document.mozPointerLockElement)}};return e("Wheel",0),window.pointer=C,C}(),ge=function(){var t=function(t,e){inputs.registry["keyboard."+t]=e};const e={string:"",lastKey:"",lastCode:"",alt:!1,shift:!1,ctrl:!1,clear(){delete e.lastKey,delete e.lastCode,e.string="",e.alt=!1,e.shift=!1,e.ctrl=!1},check:[],onDown(i){e.shift=i.shiftKey,e.alt=i.altKey,e.ctrl=i.ctrlKey,e.lastKey=i.key,e.lastCode=i.code,i.code?t(i.code,1):t("Unknown",1),i.key&&(1===i.key.length?e.string+=i.key:"Backspace"===i.key?e.string=e.string.slice(0,-1):"Enter"===i.key&&(e.string="")),pe.preventDefault&&i.preventDefault()},onUp(i){e.shift=i.shiftKey,e.alt=i.altKey,e.ctrl=i.ctrlKey,i.code?t(i.code,0):t("Unknown",0),pe.preventDefault&&i.preventDefault()}};return document.addEventListener?(document.addEventListener("keydown",e.onDown,!1),document.addEventListener("keyup",e.onUp,!1)):(document.attachEvent("onkeydown",e.onDown),document.attachEvent("onkeyup",e.onUp)),window.keyboard=e,e}();var ve,xe;!function(t){"use strict";var e="KeyboardEvent"in t;e||(t.KeyboardEvent=function(){throw TypeError("Illegal constructor")}),[["DOM_KEY_LOCATION_STANDARD",0],["DOM_KEY_LOCATION_LEFT",1],["DOM_KEY_LOCATION_RIGHT",2],["DOM_KEY_LOCATION_NUMPAD",3]].forEach((function(e){e[0]in t.KeyboardEvent||(t.KeyboardEvent[e[0]]=e[1])}));var i=t.KeyboardEvent.DOM_KEY_LOCATION_STANDARD,o=t.KeyboardEvent.DOM_KEY_LOCATION_LEFT,n=t.KeyboardEvent.DOM_KEY_LOCATION_RIGHT,s=t.KeyboardEvent.DOM_KEY_LOCATION_NUMPAD;function r(t,e){return-1!==String(t).indexOf(e)}var a=r(navigator.platform,"Win")?"win":r(navigator.platform,"Mac")?"mac":r(navigator.platform,"CrOS")?"cros":r(navigator.platform,"Linux")?"linux":r(navigator.userAgent,"iPad")||r(navigator.platform,"iPod")||r(navigator.platform,"iPhone")?"ios":"",l=r(navigator.userAgent,"Chrome/")?"chrome":r(navigator.vendor,"Apple")?"safari":r(navigator.userAgent,"MSIE")?"ie":r(navigator.userAgent,"Gecko/")?"moz":r(navigator.userAgent,"Opera/")?"opera":"",h=l+"-"+a;function c(t,e,i){h!==e&&l!==e&&a!==e||Object.keys(i).forEach((function(e){t[e]=i[e]}))}var d={3:{code:"Cancel"},6:{code:"Help"},8:{code:"Backspace"},9:{code:"Tab"},12:{code:"Clear"},13:{code:"Enter"},16:{code:"Shift"},17:{code:"Control"},18:{code:"Alt"},19:{code:"Pause"},20:{code:"CapsLock"},21:{code:"KanaMode"},22:{code:"Lang1"},25:{code:"Lang2"},27:{code:"Escape"},28:{code:"Convert"},29:{code:"NonConvert"},30:{code:"Accept"},31:{code:"ModeChange"},32:{code:"Space"},33:{code:"PageUp"},34:{code:"PageDown"},35:{code:"End"},36:{code:"Home"},37:{code:"ArrowLeft"},38:{code:"ArrowUp"},39:{code:"ArrowRight"},40:{code:"ArrowDown"},41:{code:"Select"},42:{code:"Print"},43:{code:"Execute"},44:{code:"PrintScreen"},45:{code:"Insert"},46:{code:"Delete"},47:{code:"Help"},48:{code:"Digit0",keyCap:"0"},49:{code:"Digit1",keyCap:"1"},50:{code:"Digit2",keyCap:"2"},51:{code:"Digit3",keyCap:"3"},52:{code:"Digit4",keyCap:"4"},53:{code:"Digit5",keyCap:"5"},54:{code:"Digit6",keyCap:"6"},55:{code:"Digit7",keyCap:"7"},56:{code:"Digit8",keyCap:"8"},57:{code:"Digit9",keyCap:"9"},65:{code:"KeyA",keyCap:"a"},66:{code:"KeyB",keyCap:"b"},67:{code:"KeyC",keyCap:"c"},68:{code:"KeyD",keyCap:"d"},69:{code:"KeyE",keyCap:"e"},70:{code:"KeyF",keyCap:"f"},71:{code:"KeyG",keyCap:"g"},72:{code:"KeyH",keyCap:"h"},73:{code:"KeyI",keyCap:"i"},74:{code:"KeyJ",keyCap:"j"},75:{code:"KeyK",keyCap:"k"},76:{code:"KeyL",keyCap:"l"},77:{code:"KeyM",keyCap:"m"},78:{code:"KeyN",keyCap:"n"},79:{code:"KeyO",keyCap:"o"},80:{code:"KeyP",keyCap:"p"},81:{code:"KeyQ",keyCap:"q"},82:{code:"KeyR",keyCap:"r"},83:{code:"KeyS",keyCap:"s"},84:{code:"KeyT",keyCap:"t"},85:{code:"KeyU",keyCap:"u"},86:{code:"KeyV",keyCap:"v"},87:{code:"KeyW",keyCap:"w"},88:{code:"KeyX",keyCap:"x"},89:{code:"KeyY",keyCap:"y"},90:{code:"KeyZ",keyCap:"z"},91:{code:"MetaLeft",location:o},92:{code:"MetaRight",location:n},93:{code:"ContextMenu"},95:{code:"Standby"},96:{code:"Numpad0",keyCap:"0",location:s},97:{code:"Numpad1",keyCap:"1",location:s},98:{code:"Numpad2",keyCap:"2",location:s},99:{code:"Numpad3",keyCap:"3",location:s},100:{code:"Numpad4",keyCap:"4",location:s},101:{code:"Numpad5",keyCap:"5",location:s},102:{code:"Numpad6",keyCap:"6",location:s},103:{code:"Numpad7",keyCap:"7",location:s},104:{code:"Numpad8",keyCap:"8",location:s},105:{code:"Numpad9",keyCap:"9",location:s},106:{code:"NumpadMultiply",keyCap:"*",location:s},107:{code:"NumpadAdd",keyCap:"+",location:s},108:{code:"NumpadComma",keyCap:",",location:s},109:{code:"NumpadSubtract",keyCap:"-",location:s},110:{code:"NumpadDecimal",keyCap:".",location:s},111:{code:"NumpadDivide",keyCap:"/",location:s},112:{code:"F1"},113:{code:"F2"},114:{code:"F3"},115:{code:"F4"},116:{code:"F5"},117:{code:"F6"},118:{code:"F7"},119:{code:"F8"},120:{code:"F9"},121:{code:"F10"},122:{code:"F11"},123:{code:"F12"},124:{code:"F13"},125:{code:"F14"},126:{code:"F15"},127:{code:"F16"},128:{code:"F17"},129:{code:"F18"},130:{code:"F19"},131:{code:"F20"},132:{code:"F21"},133:{code:"F22"},134:{code:"F23"},135:{code:"F24"},144:{code:"NumLock",location:s},145:{code:"ScrollLock"},160:{code:"ShiftLeft",location:o},161:{code:"ShiftRight",location:n},162:{code:"ControlLeft",location:o},163:{code:"ControlRight",location:n},164:{code:"AltLeft",location:o},165:{code:"AltRight",location:n},166:{code:"BrowserBack"},167:{code:"BrowserForward"},168:{code:"BrowserRefresh"},169:{code:"BrowserStop"},170:{code:"BrowserSearch"},171:{code:"BrowserFavorites"},172:{code:"BrowserHome"},173:{code:"AudioVolumeMute"},174:{code:"AudioVolumeDown"},175:{code:"AudioVolumeUp"},176:{code:"MediaTrackNext"},177:{code:"MediaTrackPrevious"},178:{code:"MediaStop"},179:{code:"MediaPlayPause"},180:{code:"LaunchMail"},181:{code:"MediaSelect"},182:{code:"LaunchApp1"},183:{code:"LaunchApp2"},186:{code:"Semicolon",keyCap:";"},187:{code:"Equal",keyCap:"="},188:{code:"Comma",keyCap:","},189:{code:"Minus",keyCap:"-"},190:{code:"Period",keyCap:"."},191:{code:"Slash",keyCap:"/"},192:{code:"Backquote",keyCap:"`"},219:{code:"BracketLeft",keyCap:"["},220:{code:"Backslash",keyCap:"\\"},221:{code:"BracketRight",keyCap:"]"},222:{code:"Quote",keyCap:"'"},226:{code:"IntlBackslash",keyCap:"\\"},229:{code:"Process"},246:{code:"Attn"},247:{code:"CrSel"},248:{code:"ExSel"},249:{code:"EraseEof"},250:{code:"Play"},251:{code:"ZoomToggle"},254:{code:"Clear"}};c(d,"moz",{59:{code:"Semicolon",keyCap:";"},61:{code:"Equal",keyCap:"="},107:{code:"Equal",keyCap:"="},109:{code:"Minus",keyCap:"-"},187:{code:"NumpadAdd",keyCap:"+",location:s},189:{code:"NumpadSubtract",keyCap:"-",location:s}}),c(d,"moz-mac",{12:{code:"NumLock",location:s},173:{code:"Minus",keyCap:"-"}}),c(d,"moz-win",{173:{code:"Minus",keyCap:"-"}}),c(d,"chrome-mac",{93:{code:"MetaRight",location:n}}),c(d,"safari",{3:{code:"Enter"},25:{code:"Tab"}}),c(d,"ios",{10:{code:"Enter",location:i}}),c(d,"safari-mac",{91:{code:"MetaLeft",location:o},93:{code:"MetaRight",location:n},229:{code:"KeyQ",keyCap:"Q"}});var u={};"cros"===a&&(u["U+00A0"]={code:"ShiftLeft",location:o},u["U+00A1"]={code:"ShiftRight",location:n},u["U+00A2"]={code:"ControlLeft",location:o},u["U+00A3"]={code:"ControlRight",location:n},u["U+00A4"]={code:"AltLeft",location:o},u["U+00A5"]={code:"AltRight",location:n}),"chrome-mac"===h&&(u["U+0010"]={code:"ContextMenu"}),"safari-mac"===h&&(u["U+0010"]={code:"ContextMenu"}),"ios"===a&&(u["U+0010"]={code:"Function"},u["U+001C"]={code:"ArrowLeft"},u["U+001D"]={code:"ArrowRight"},u["U+001E"]={code:"ArrowUp"},u["U+001F"]={code:"ArrowDown"},u["U+0001"]={code:"Home"},u["U+0004"]={code:"End"},u["U+000B"]={code:"PageUp"},u["U+000C"]={code:"PageDown"});var p=[];p[o]={16:{code:"ShiftLeft",location:o},17:{code:"ControlLeft",location:o},18:{code:"AltLeft",location:o}},p[n]={16:{code:"ShiftRight",location:n},17:{code:"ControlRight",location:n},18:{code:"AltRight",location:n}},p[s]={13:{code:"NumpadEnter",location:s}},c(p[s],"moz",{109:{code:"NumpadSubtract",location:s},107:{code:"NumpadAdd",location:s}}),c(p[o],"moz-mac",{224:{code:"MetaLeft",location:o}}),c(p[n],"moz-mac",{224:{code:"MetaRight",location:n}}),c(p[n],"moz-win",{91:{code:"MetaRight",location:n}}),c(p[n],"mac",{93:{code:"MetaRight",location:n}}),c(p[s],"chrome-mac",{12:{code:"NumLock",location:s}}),c(p[s],"safari-mac",{12:{code:"NumLock",location:s},187:{code:"NumpadAdd",location:s},189:{code:"NumpadSubtract",location:s},190:{code:"NumpadDecimal",location:s},191:{code:"NumpadDivide",location:s}});var m={ShiftLeft:{key:"Shift"},ShiftRight:{key:"Shift"},ControlLeft:{key:"Control"},ControlRight:{key:"Control"},AltLeft:{key:"Alt"},AltRight:{key:"Alt"},MetaLeft:{key:"Meta"},MetaRight:{key:"Meta"},NumpadEnter:{key:"Enter"},Space:{key:" "},Digit0:{key:"0",shiftKey:")"},Digit1:{key:"1",shiftKey:"!"},Digit2:{key:"2",shiftKey:"@"},Digit3:{key:"3",shiftKey:"#"},Digit4:{key:"4",shiftKey:"$"},Digit5:{key:"5",shiftKey:"%"},Digit6:{key:"6",shiftKey:"^"},Digit7:{key:"7",shiftKey:"&"},Digit8:{key:"8",shiftKey:"*"},Digit9:{key:"9",shiftKey:"("},KeyA:{key:"a",shiftKey:"A"},KeyB:{key:"b",shiftKey:"B"},KeyC:{key:"c",shiftKey:"C"},KeyD:{key:"d",shiftKey:"D"},KeyE:{key:"e",shiftKey:"E"},KeyF:{key:"f",shiftKey:"F"},KeyG:{key:"g",shiftKey:"G"},KeyH:{key:"h",shiftKey:"H"},KeyI:{key:"i",shiftKey:"I"},KeyJ:{key:"j",shiftKey:"J"},KeyK:{key:"k",shiftKey:"K"},KeyL:{key:"l",shiftKey:"L"},KeyM:{key:"m",shiftKey:"M"},KeyN:{key:"n",shiftKey:"N"},KeyO:{key:"o",shiftKey:"O"},KeyP:{key:"p",shiftKey:"P"},KeyQ:{key:"q",shiftKey:"Q"},KeyR:{key:"r",shiftKey:"R"},KeyS:{key:"s",shiftKey:"S"},KeyT:{key:"t",shiftKey:"T"},KeyU:{key:"u",shiftKey:"U"},KeyV:{key:"v",shiftKey:"V"},KeyW:{key:"w",shiftKey:"W"},KeyX:{key:"x",shiftKey:"X"},KeyY:{key:"y",shiftKey:"Y"},KeyZ:{key:"z",shiftKey:"Z"},Numpad0:{key:"0"},Numpad1:{key:"1"},Numpad2:{key:"2"},Numpad3:{key:"3"},Numpad4:{key:"4"},Numpad5:{key:"5"},Numpad6:{key:"6"},Numpad7:{key:"7"},Numpad8:{key:"8"},Numpad9:{key:"9"},NumpadMultiply:{key:"*"},NumpadAdd:{key:"+"},NumpadComma:{key:","},NumpadSubtract:{key:"-"},NumpadDecimal:{key:"."},NumpadDivide:{key:"/"},Semicolon:{key:";",shiftKey:":"},Equal:{key:"=",shiftKey:"+"},Comma:{key:",",shiftKey:"<"},Minus:{key:"-",shiftKey:"_"},Period:{key:".",shiftKey:">"},Slash:{key:"/",shiftKey:"?"},Backquote:{key:"`",shiftKey:"~"},BracketLeft:{key:"[",shiftKey:"{"},Backslash:{key:"\\",shiftKey:"|"},BracketRight:{key:"]",shiftKey:"}"},Quote:{key:"'",shiftKey:'"'},IntlBackslash:{key:"\\",shiftKey:"|"}};c(m,"mac",{MetaLeft:{key:"Meta"},MetaRight:{key:"Meta"}});var f,y,g,v={Add:"+",Decimal:".",Divide:"/",Subtract:"-",Multiply:"*",Spacebar:" ",Esc:"Escape",Nonconvert:"NonConvert",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Menu:"ContextMenu",MediaNextTrack:"MediaTrackNext",MediaPreviousTrack:"MediaTrackPrevious",SelectMedia:"MediaSelect",HalfWidth:"Hankaku",FullWidth:"Zenkaku",RomanCharacters:"Romaji",Crsel:"CrSel",Exsel:"ExSel",Zoom:"ZoomToggle"},x=(f=d,y="code",g={},Object.keys(f).forEach((function(t){var e=f[t];y in e&&(g[e[y]]=e)})),g);try{var w=e&&"location"in new KeyboardEvent("")}catch(t){}function b(t){var e="keyCode"in t?t.keyCode:"which"in t?t.which:0,i=function(){if(w||"keyLocation"in t){var i=w?t.location:t.keyLocation;if(i&&e in p[i])return p[i][e]}return"keyIdentifier"in t&&t.keyIdentifier in u?u[t.keyIdentifier]:e in d?d[e]:null}();if(!i)return null;var o,n=(o=m[i.code])?t.shiftKey&&"shiftKey"in o?o.shiftKey:o.key:i.code;return{code:i.code,key:n,location:i.location,keyCap:i.keyCap}}"KeyboardEvent"in t&&"defineProperty"in Object&&function(){function t(t,e,i){e in t||Object.defineProperty(t,e,i)}if(t(KeyboardEvent.prototype,"code",{get:function(){var t=b(this);return t?t.code:""}}),"key"in KeyboardEvent.prototype){var e=Object.getOwnPropertyDescriptor(KeyboardEvent.prototype,"key");Object.defineProperty(KeyboardEvent.prototype,"key",{get:function(){var t=e.get.call(this);return v.hasOwnProperty(t)?v[t]:t}})}t(KeyboardEvent.prototype,"key",{get:function(){var t=b(this);return t&&"key"in t?t.key:"Unidentified"}}),t(KeyboardEvent.prototype,"location",{get:function(){var t=b(this);return t&&"location"in t?t.location:i}}),t(KeyboardEvent.prototype,"locale",{get:function(){return""}})}(),"queryKeyCap"in t.KeyboardEvent||(t.KeyboardEvent.queryKeyCap=function(t,e){if(t=String(t),!x.hasOwnProperty(t))return"Undefined";if(e&&"en-us"!==String(e).toLowerCase())throw Error("Unsupported locale");var i=x[t];return i.keyCap||i.code||"Undefined"}),t.identifyKey=function(t){if(!("code"in t)){var e=b(t);t.code=e?e.code:"",t.key=e&&"key"in e?e.key:"Unidentified",t.location="location"in t?t.location:"keyLocation"in t?t.keyLocation:e&&"location"in e?e.location:i,t.locale=""}}}(self),ve=this,xe=function(){"use strict";function t(t,e){e=e||Object.create(null);var i,o=document.createEvent("Event");o.initEvent(t,e.bubbles||!1,e.cancelable||!1);for(var n,s=2;s<h.length;s++)o[n=h[s]]=e[n]||c[s];return o.buttons=e.buttons||0,i=e.pressure&&o.buttons?e.pressure:o.buttons?.5:0,o.x=o.clientX,o.y=o.clientY,o.pointerId=e.pointerId||0,o.width=e.width||0,o.height=e.height||0,o.pressure=i,o.tiltX=e.tiltX||0,o.tiltY=e.tiltY||0,o.twist=e.twist||0,o.tangentialPressure=e.tangentialPressure||0,o.pointerType=e.pointerType||"",o.hwTimestamp=e.hwTimestamp||0,o.isPrimary=e.isPrimary||!1,o}function e(){this.array=[],this.size=0}function i(t,e,i,o){this.addCallback=t.bind(o),this.removeCallback=e.bind(o),this.changedCallback=i.bind(o),S&&(this.observer=new S(this.mutationWatcher.bind(this)))}function o(t){return"body /shadow-deep/ "+n(t)}function n(t){return'[touch-action="'+t+'"]'}function s(t){return"{ -ms-touch-action: "+t+"; touch-action: "+t+"; }"}function r(t){if(!y.pointermap.has(t)){var e=new Error("InvalidPointerId");throw e.name="InvalidPointerId",e}}function a(t){for(var e=t.parentNode;e&&e!==t.ownerDocument;)e=e.parentNode;if(!e){var i=new Error("InvalidStateError");throw i.name="InvalidStateError",i}}function l(t){return 0!==y.pointermap.get(t).buttons}var h=["bubbles","cancelable","view","detail","screenX","screenY","clientX","clientY","ctrlKey","altKey","shiftKey","metaKey","button","relatedTarget","pageX","pageY"],c=[!1,!1,null,null,0,0,0,0,!1,!1,!1,!1,0,null,0,0],d=window.Map&&window.Map.prototype.forEach?Map:e;e.prototype={set:function(t,e){return void 0===e?this.delete(t):(this.has(t)||this.size++,void(this.array[t]=e))},has:function(t){return void 0!==this.array[t]},delete:function(t){this.has(t)&&(delete this.array[t],this.size--)},get:function(t){return this.array[t]},clear:function(){this.array.length=0,this.size=0},forEach:function(t,e){return this.array.forEach((function(i,o){t.call(e,i,o,this)}),this)}};var u=["bubbles","cancelable","view","detail","screenX","screenY","clientX","clientY","ctrlKey","altKey","shiftKey","metaKey","button","relatedTarget","buttons","pointerId","width","height","pressure","tiltX","tiltY","pointerType","hwTimestamp","isPrimary","type","target","currentTarget","which","pageX","pageY","timeStamp"],p=[!1,!1,null,null,0,0,0,0,!1,!1,!1,!1,0,null,0,0,0,0,0,0,0,"",0,!1,"",null,null,0,0,0,0],m={pointerover:1,pointerout:1,pointerenter:1,pointerleave:1},f="undefined"!=typeof SVGElementInstance,y={pointermap:new d,eventMap:Object.create(null),captureInfo:Object.create(null),eventSources:Object.create(null),eventSourceList:[],registerSource:function(t,e){var i=e,o=i.events;o&&(o.forEach((function(t){i[t]&&(this.eventMap[t]=i[t].bind(i))}),this),this.eventSources[t]=i,this.eventSourceList.push(i))},register:function(t){for(var e,i=this.eventSourceList.length,o=0;o<i&&(e=this.eventSourceList[o]);o++)e.register.call(e,t)},unregister:function(t){for(var e,i=this.eventSourceList.length,o=0;o<i&&(e=this.eventSourceList[o]);o++)e.unregister.call(e,t)},contains:function(t,e){try{return t.contains(e)}catch(t){return!1}},down:function(t){t.bubbles=!0,this.fireEvent("pointerdown",t)},move:function(t){t.bubbles=!0,this.fireEvent("pointermove",t)},up:function(t){t.bubbles=!0,this.fireEvent("pointerup",t)},enter:function(t){t.bubbles=!1,this.fireEvent("pointerenter",t)},leave:function(t){t.bubbles=!1,this.fireEvent("pointerleave",t)},over:function(t){t.bubbles=!0,this.fireEvent("pointerover",t)},out:function(t){t.bubbles=!0,this.fireEvent("pointerout",t)},cancel:function(t){t.bubbles=!0,this.fireEvent("pointercancel",t)},leaveOut:function(t){this.out(t),this.propagate(t,this.leave,!1)},enterOver:function(t){this.over(t),this.propagate(t,this.enter,!0)},eventHandler:function(t){if(!t._handledByPE){var e=t.type,i=this.eventMap&&this.eventMap[e];i&&i(t),t._handledByPE=!0}},listen:function(t,e){e.forEach((function(e){this.addEvent(t,e)}),this)},unlisten:function(t,e){e.forEach((function(e){this.removeEvent(t,e)}),this)},addEvent:function(t,e){t.addEventListener(e,this.boundHandler)},removeEvent:function(t,e){t.removeEventListener(e,this.boundHandler)},makeEvent:function(e,i){this.captureInfo[i.pointerId]&&(i.relatedTarget=null);var o=new t(e,i);return i.preventDefault&&(o.preventDefault=i.preventDefault),o._target=o._target||i.target,o},fireEvent:function(t,e){var i=this.makeEvent(t,e);return this.dispatchEvent(i)},cloneEvent:function(t){for(var e,i=Object.create(null),o=0;o<u.length;o++)i[e=u[o]]=t[e]||p[o],!f||"target"!==e&&"relatedTarget"!==e||i[e]instanceof SVGElementInstance&&(i[e]=i[e].correspondingUseElement);return t.preventDefault&&(i.preventDefault=function(){t.preventDefault()}),i},getTarget:function(t){var e=this.captureInfo[t.pointerId];return e?t._target!==e&&t.type in m?void 0:e:t._target},propagate:function(t,e,i){for(var o=t.target,n=[];o!==document&&!o.contains(t.relatedTarget);)if(n.push(o),!(o=o.parentNode))return;i&&n.reverse(),n.forEach((function(i){t.target=i,e.call(this,t)}),this)},setCapture:function(e,i,o){this.captureInfo[e]&&this.releaseCapture(e,o),this.captureInfo[e]=i,this.implicitRelease=this.releaseCapture.bind(this,e,o),document.addEventListener("pointerup",this.implicitRelease),document.addEventListener("pointercancel",this.implicitRelease);var n=new t("gotpointercapture");n.pointerId=e,n._target=i,o||this.asyncDispatchEvent(n)},releaseCapture:function(e,i){var o=this.captureInfo[e];if(o){this.captureInfo[e]=void 0,document.removeEventListener("pointerup",this.implicitRelease),document.removeEventListener("pointercancel",this.implicitRelease);var n=new t("lostpointercapture");n.pointerId=e,n._target=o,i||this.asyncDispatchEvent(n)}},dispatchEvent:function(t){var e=this.getTarget(t);if(e)return e.dispatchEvent(t)},asyncDispatchEvent:function(t){requestAnimationFrame(this.dispatchEvent.bind(this,t))}};y.boundHandler=y.eventHandler.bind(y);var g={shadow:function(t){if(t)return t.shadowRoot||t.webkitShadowRoot},canTarget:function(t){return t&&Boolean(t.elementFromPoint)},targetingShadow:function(t){var e=this.shadow(t);if(this.canTarget(e))return e},olderShadow:function(t){var e=t.olderShadowRoot;if(!e){var i=t.querySelector("shadow");i&&(e=i.olderShadowRoot)}return e},allShadows:function(t){for(var e=[],i=this.shadow(t);i;)e.push(i),i=this.olderShadow(i);return e},searchRoot:function(t,e,i){if(t){var o,n,s=t.elementFromPoint(e,i);for(n=this.targetingShadow(s);n;){if(o=n.elementFromPoint(e,i)){var r=this.targetingShadow(o);return this.searchRoot(r,e,i)||o}n=this.olderShadow(n)}return s}},owner:function(t){for(var e=t;e.parentNode;)e=e.parentNode;return e.nodeType!==Node.DOCUMENT_NODE&&e.nodeType!==Node.DOCUMENT_FRAGMENT_NODE&&(e=document),e},findTarget:function(t){var e=t.clientX,i=t.clientY,o=this.owner(t.target);return o.elementFromPoint(e,i)||(o=document),this.searchRoot(o,e,i)}},v=Array.prototype.forEach.call.bind(Array.prototype.forEach),x=Array.prototype.map.call.bind(Array.prototype.map),w=Array.prototype.slice.call.bind(Array.prototype.slice),b=Array.prototype.filter.call.bind(Array.prototype.filter),S=window.MutationObserver||window.WebKitMutationObserver,C={subtree:!0,childList:!0,attributes:!0,attributeOldValue:!0,attributeFilter:["touch-action"]};i.prototype={watchSubtree:function(t){this.observer&&g.canTarget(t)&&this.observer.observe(t,C)},enableOnSubtree:function(t){this.watchSubtree(t),t===document&&"complete"!==document.readyState?this.installOnLoad():this.installNewSubtree(t)},installNewSubtree:function(t){v(this.findElements(t),this.addElement,this)},findElements:function(t){return t.querySelectorAll?t.querySelectorAll("[touch-action]"):[]},removeElement:function(t){this.removeCallback(t)},addElement:function(t){this.addCallback(t)},elementChanged:function(t,e){this.changedCallback(t,e)},concatLists:function(t,e){return t.concat(w(e))},installOnLoad:function(){document.addEventListener("readystatechange",function(){"complete"===document.readyState&&this.installNewSubtree(document)}.bind(this))},isElement:function(t){return t.nodeType===Node.ELEMENT_NODE},flattenMutationTree:function(t){var e=x(t,this.findElements,this);return e.push(b(t,this.isElement)),e.reduce(this.concatLists,[])},mutationWatcher:function(t){t.forEach(this.mutationHandler,this)},mutationHandler:function(t){"childList"===t.type?(this.flattenMutationTree(t.addedNodes).forEach(this.addElement,this),this.flattenMutationTree(t.removedNodes).forEach(this.removeElement,this)):"attributes"===t.type&&this.elementChanged(t.target,t.oldValue)}};var I=["none","auto","pan-x","pan-y",{rule:"pan-x pan-y",selectors:["pan-x pan-y","pan-y pan-x"]}],P="",k=window.PointerEvent||window.MSPointerEvent,T=!window.ShadowDOMPolyfill&&document.head.createShadowRoot,M=y.pointermap,E=[1,4,2,8,16],O=!1;try{O=1===new MouseEvent("test",{buttons:1}).buttons}catch(t){}var D,A={POINTER_ID:1,POINTER_TYPE:"mouse",events:["mousedown","mousemove","mouseup","mouseover","mouseout"],register:function(t){y.listen(t,this.events)},unregister:function(t){y.unlisten(t,this.events)},lastTouches:[],isEventSimulatedFromTouch:function(t){for(var e,i=this.lastTouches,o=t.clientX,n=t.clientY,s=0,r=i.length;s<r&&(e=i[s]);s++){var a=Math.abs(o-e.x),l=Math.abs(n-e.y);if(a<=25&&l<=25)return!0}},prepareEvent:function(t){var e=y.cloneEvent(t),i=e.preventDefault;return e.preventDefault=function(){t.preventDefault(),i()},e.pointerId=this.POINTER_ID,e.isPrimary=!0,e.pointerType=this.POINTER_TYPE,e},prepareButtonsForMove:function(t,e){var i=M.get(this.POINTER_ID);0!==e.which&&i?t.buttons=i.buttons:t.buttons=0,e.buttons=t.buttons},mousedown:function(t){if(!this.isEventSimulatedFromTouch(t)){var e=M.get(this.POINTER_ID),i=this.prepareEvent(t);O||(i.buttons=E[i.button],e&&(i.buttons|=e.buttons),t.buttons=i.buttons),M.set(this.POINTER_ID,t),e&&0!==e.buttons?y.move(i):y.down(i)}},mousemove:function(t){if(!this.isEventSimulatedFromTouch(t)){var e=this.prepareEvent(t);O||this.prepareButtonsForMove(e,t),e.button=-1,M.set(this.POINTER_ID,t),y.move(e)}},mouseup:function(t){if(!this.isEventSimulatedFromTouch(t)){var e=M.get(this.POINTER_ID),i=this.prepareEvent(t);if(!O){var o=E[i.button];i.buttons=e?e.buttons&~o:0,t.buttons=i.buttons}M.set(this.POINTER_ID,t),i.buttons&=~E[i.button],0===i.buttons?y.up(i):y.move(i)}},mouseover:function(t){if(!this.isEventSimulatedFromTouch(t)){var e=this.prepareEvent(t);O||this.prepareButtonsForMove(e,t),e.button=-1,M.set(this.POINTER_ID,t),y.enterOver(e)}},mouseout:function(t){if(!this.isEventSimulatedFromTouch(t)){var e=this.prepareEvent(t);O||this.prepareButtonsForMove(e,t),e.button=-1,y.leaveOut(e)}},cancel:function(t){var e=this.prepareEvent(t);y.cancel(e),this.deactivateMouse()},deactivateMouse:function(){M.delete(this.POINTER_ID)}},X=y.captureInfo,N=g.findTarget.bind(g),L=g.allShadows.bind(g),R=y.pointermap,_="touch-action",Y={events:["touchstart","touchmove","touchend","touchcancel"],register:function(t){D.enableOnSubtree(t)},unregister:function(){},elementAdded:function(t){var e=t.getAttribute(_),i=this.touchActionToScrollType(e);i&&(t._scrollType=i,y.listen(t,this.events),L(t).forEach((function(t){t._scrollType=i,y.listen(t,this.events)}),this))},elementRemoved:function(t){t._scrollType=void 0,y.unlisten(t,this.events),L(t).forEach((function(t){t._scrollType=void 0,y.unlisten(t,this.events)}),this)},elementChanged:function(t,e){var i=t.getAttribute(_),o=this.touchActionToScrollType(i),n=this.touchActionToScrollType(e);o&&n?(t._scrollType=o,L(t).forEach((function(t){t._scrollType=o}),this)):n?this.elementRemoved(t):o&&this.elementAdded(t)},scrollTypes:{EMITTER:"none",XSCROLLER:"pan-x",YSCROLLER:"pan-y",SCROLLER:/^(?:pan-x pan-y)|(?:pan-y pan-x)|auto$/},touchActionToScrollType:function(t){var e=t,i=this.scrollTypes;return"none"===e?"none":e===i.XSCROLLER?"X":e===i.YSCROLLER?"Y":i.SCROLLER.exec(e)?"XY":void 0},POINTER_TYPE:"touch",firstTouch:null,isPrimaryTouch:function(t){return this.firstTouch===t.identifier},setPrimaryTouch:function(t){(0===R.size||1===R.size&&R.has(1))&&(this.firstTouch=t.identifier,this.firstXY={X:t.clientX,Y:t.clientY},this.scrolling=!1,this.cancelResetClickCount())},removePrimaryPointer:function(t){t.isPrimary&&(this.firstTouch=null,this.firstXY=null,this.resetClickCount())},clickCount:0,resetId:null,resetClickCount:function(){var t=function(){this.clickCount=0,this.resetId=null}.bind(this);this.resetId=setTimeout(t,200)},cancelResetClickCount:function(){this.resetId&&clearTimeout(this.resetId)},typeToButtons:function(t){var e=0;return"touchstart"!==t&&"touchmove"!==t||(e=1),e},touchToPointer:function(t){var e=this.currentTouchEvent,i=y.cloneEvent(t),o=i.pointerId=t.identifier+2;i.target=X[o]||N(i),i.bubbles=!0,i.cancelable=!0,i.detail=this.clickCount,i.button=0,i.buttons=this.typeToButtons(e.type),i.width=2*(t.radiusX||t.webkitRadiusX||0),i.height=2*(t.radiusY||t.webkitRadiusY||0),i.pressure=t.force||t.webkitForce||.5,i.isPrimary=this.isPrimaryTouch(t),i.pointerType=this.POINTER_TYPE,i.altKey=e.altKey,i.ctrlKey=e.ctrlKey,i.metaKey=e.metaKey,i.shiftKey=e.shiftKey;var n=this;return i.preventDefault=function(){n.scrolling=!1,n.firstXY=null,e.preventDefault()},i},processTouches:function(t,e){var i=t.changedTouches;this.currentTouchEvent=t;for(var o,n=0;n<i.length;n++)o=i[n],e.call(this,this.touchToPointer(o))},shouldScroll:function(t){if(this.firstXY){var e,i=t.currentTarget._scrollType;if("none"===i)e=!1;else if("XY"===i)e=!0;else{var o=t.changedTouches[0],n=i,s="Y"===i?"X":"Y";e=Math.abs(o["client"+n]-this.firstXY[n])>=Math.abs(o["client"+s]-this.firstXY[s])}return this.firstXY=null,e}},findTouch:function(t,e){for(var i,o=0,n=t.length;o<n&&(i=t[o]);o++)if(i.identifier===e)return!0},vacuumTouches:function(t){var e=t.touches;if(R.size>=e.length){var i=[];R.forEach((function(t,o){if(1!==o&&!this.findTouch(e,o-2)){var n=t.out;i.push(n)}}),this),i.forEach(this.cancelOut,this)}},touchstart:function(t){this.vacuumTouches(t),this.setPrimaryTouch(t.changedTouches[0]),this.dedupSynthMouse(t),this.scrolling||(this.clickCount++,this.processTouches(t,this.overDown))},overDown:function(t){R.set(t.pointerId,{target:t.target,out:t,outTarget:t.target}),y.enterOver(t),y.down(t)},touchmove:function(t){this.scrolling||(this.shouldScroll(t)?(this.scrolling=!0,this.touchcancel(t)):(t.preventDefault(),this.processTouches(t,this.moveOverOut)))},moveOverOut:function(t){var e=t,i=R.get(e.pointerId);if(i){var o=i.out,n=i.outTarget;y.move(e),o&&n!==e.target&&(o.relatedTarget=e.target,e.relatedTarget=n,o.target=n,e.target?(y.leaveOut(o),y.enterOver(e)):(e.target=n,e.relatedTarget=null,this.cancelOut(e))),i.out=e,i.outTarget=e.target}},touchend:function(t){this.dedupSynthMouse(t),this.processTouches(t,this.upOut)},upOut:function(t){this.scrolling||(y.up(t),y.leaveOut(t)),this.cleanUpPointer(t)},touchcancel:function(t){this.processTouches(t,this.cancelOut)},cancelOut:function(t){y.cancel(t),y.leaveOut(t),this.cleanUpPointer(t)},cleanUpPointer:function(t){R.delete(t.pointerId),this.removePrimaryPointer(t)},dedupSynthMouse:function(t){var e=A.lastTouches,i=t.changedTouches[0];if(this.isPrimaryTouch(i)){var o={x:i.clientX,y:i.clientY};e.push(o);var n=function(t,e){var i=t.indexOf(e);i>-1&&t.splice(i,1)}.bind(null,e,o);setTimeout(n,2500)}}};D=new i(Y.elementAdded,Y.elementRemoved,Y.elementChanged,Y);var B,K,F,U=y.pointermap,j=window.MSPointerEvent&&"number"==typeof window.MSPointerEvent.MSPOINTER_TYPE_MOUSE,$={events:["MSPointerDown","MSPointerMove","MSPointerUp","MSPointerOut","MSPointerOver","MSPointerCancel","MSGotPointerCapture","MSLostPointerCapture"],register:function(t){y.listen(t,this.events)},unregister:function(t){y.unlisten(t,this.events)},POINTER_TYPES:["","unavailable","touch","pen","mouse"],prepareEvent:function(t){var e=t;return j&&((e=y.cloneEvent(t)).pointerType=this.POINTER_TYPES[t.pointerType]),e},cleanup:function(t){U.delete(t)},MSPointerDown:function(t){U.set(t.pointerId,t);var e=this.prepareEvent(t);y.down(e)},MSPointerMove:function(t){var e=this.prepareEvent(t);y.move(e)},MSPointerUp:function(t){var e=this.prepareEvent(t);y.up(e),this.cleanup(t.pointerId)},MSPointerOut:function(t){var e=this.prepareEvent(t);y.leaveOut(e)},MSPointerOver:function(t){var e=this.prepareEvent(t);y.enterOver(e)},MSPointerCancel:function(t){var e=this.prepareEvent(t);y.cancel(e),this.cleanup(t.pointerId)},MSLostPointerCapture:function(t){var e=y.makeEvent("lostpointercapture",t);y.dispatchEvent(e)},MSGotPointerCapture:function(t){var e=y.makeEvent("gotpointercapture",t);y.dispatchEvent(e)}};return window.navigator.msPointerEnabled?(B=function(t){r(t),a(this),l(t)&&(y.setCapture(t,this,!0),this.msSetPointerCapture(t))},K=function(t){r(t),y.releaseCapture(t,!0),this.msReleasePointerCapture(t)}):(B=function(t){r(t),a(this),l(t)&&y.setCapture(t,this)},K=function(t){r(t),y.releaseCapture(t)}),F=function(t){return!!y.captureInfo[t]},function(){if(k){I.forEach((function(t){String(t)===t?(P+=n(t)+s(t)+"\n",T&&(P+=o(t)+s(t)+"\n")):(P+=t.selectors.map(n)+s(t.rule)+"\n",T&&(P+=t.selectors.map(o)+s(t.rule)+"\n"))}));var t=document.createElement("style");t.textContent=P,document.head.appendChild(t)}}(),function(){if(!window.PointerEvent){if(window.PointerEvent=t,window.navigator.msPointerEnabled){var e=window.navigator.msMaxTouchPoints;Object.defineProperty(window.navigator,"maxTouchPoints",{value:e,enumerable:!0}),y.registerSource("ms",$)}else Object.defineProperty(window.navigator,"maxTouchPoints",{value:0,enumerable:!0}),y.registerSource("mouse",A),void 0!==window.ontouchstart&&y.registerSource("touch",Y);y.register(document)}}(),window.Element&&!Element.prototype.setPointerCapture&&Object.defineProperties(Element.prototype,{setPointerCapture:{value:B},releasePointerCapture:{value:K},hasPointerCapture:{value:F}}),{dispatcher:y,Installer:i,PointerEvent:t,PointerMap:d,targetFinding:g}},"object"==typeof exports&&"undefined"!=typeof module?module.exports=xe():"function"==typeof define&&define.amd?define(xe):ve.PointerEventsPolyfill=xe();!function(){const t={controllers:{},buttonsMapping:["Button1","Button2","Button3","Button4","L1","R1","L2","R2","Select","Start","L3","R3","Up","Down","Left","Right"],axesMapping:["LStickX","LStickY","RStickX","RStickY"]},e="gamepad.",i=function(t,i){inputs.registry[e+t]=i},o=function(t){return inputs.registry[e+t]||0},n=function(){return navigator.getGamepads?navigator.getGamepads():[]},s=function(e){t.controllers[e.index]=e},r=Object.assign(new PIXI.utils.EventEmitter,{list:n(),connected(t){r.emit("connected",t.gamepad,t),s(t.gamepad)},disconnected(e){r.emit("disconnected",e.gamepad,e),delete t.controllers[e.gamepad.index]},getButton:e=>{if(-1===t.buttonsMapping.indexOf(e)&&"Any"!==e)throw new Error(`[gamepad] Attempt to get the state of a non-existing button ${e}. A typo?`);return o(e)},getAxis:e=>{if(-1===t.axesMapping.indexOf(e))throw new Error(`[gamepad] Attempt to get the state of a non-existing axis ${e}. A typo?`);return o(e)},lastButton:null});window.addEventListener("gamepadconnected",r.connected),window.addEventListener("gamepaddisconnected",r.disconnected),le.ticker.add((function(){let e;!function(){const e=n();for(let i=0,o=e.length;i<o;i++)if(e[i]){const{controllers:o}=t;e[i].index in o?o[e[i].index]=e[i]:s(e[i])}}();const{controllers:a}=t,{buttonsMapping:l}=t,{axesMapping:h}=t;for(e in a){const t=a[e],n=t.buttons.length;i("Any",0);for(let e=0;e<n;e++)i(l[e],t.buttons[e].value),i("Any",Math.max(o("Any"),t.buttons[e].value)),r.lastButton=l[e];const s=t.axes.length;for(let e=0;e<s;e++)i(h[e],t.axes[e])}}))}();const we=function(t){return Math.random()*t};Object.assign(we,{dice:(...t)=>t[Math.floor(Math.random()*t.length)],histogram(...t){const e=[...t];let i=0;for(let t=0;t<e.length;t++)i+=e[t],t>0&&(e[t]+=e[t-1]);const o=Math.random()*i;var n;for(n=0;n<e.length&&!(e[n]>o);n++);return n/e.length+Math.random()/e.length},optimistic:t=>1-we.pessimistic(t),pessimistic:t=>(t=t||2,Math.random()**t),range:(t,e)=>t+Math.random()*(e-t),deg:()=>360*Math.random(),coord:()=>[Math.floor(Math.random()*camera.width),Math.floor(Math.random()*camera.height)],chance:(t,e)=>e?Math.random()*e<t:100*Math.random()<t,from:t=>t[Math.floor(Math.random()*t.length)],text(t){const e=[];for(let i=0;i<t.length;i++)if("{"===t[i])e.push({start:i,end:void 0});else if("}"===t[i]){const o=e.pop();if(!o)throw new Error(`Unbalanced braces. Faced an extra closing bracket at pos ${i}.`);o.end=i;const n=t.slice(o.start+1,o.end).split("|"),s=n[Math.floor(Math.random()*n.length)];t=t.slice(0,o.start)+s+t.slice(o.end+1),i-=o.end-o.start+1-s.length}if(e.length>0)throw new Error(`Unbalanced braces. Faced an extra opening bracket at pos ${e.pop().start}.`);return t},createSeededRandomizer:t=>function(){var e=t+=1831565813;return e=Math.imul(e^e>>>15,1|e),(((e^=e+Math.imul(e^e>>>7,61|e))^e>>>14)>>>0)/4294967296}});{const t={};t.currentRootRandomizer=we.createSeededRandomizer(456852),we.seeded=function(){return t.currentRootRandomizer()},we.setSeed=function(e){t.currentRootRandomizer=we.createSeededRandomizer(e)},we.setSeed(9323846264)}flow={wait:u.wait,gate(t,e){e=Boolean(e);var i=function(){return!!e&&t()};return i.toggle=function(){e=!e},i.open=function(){e=!0},i.close=function(){e=!1},i},delay(t,e){const i=rooms.current;var o;return function(){o||(o=setTimeout((()=>{i===rooms.current&&t(),o=!1}),e))}},retriggerableDelay(t,e){const i=rooms.current;var o;return function(){o&&clearTimeout(o),o=setTimeout((()=>{i===rooms.current&&t(),o=!1}),e)}},timer(t,e,i=!1){var o;return function(){o||(o=!0,i?u.waitUi(e).then((()=>{o=!1})):u.wait(e).then((()=>{o=!1})),t())}}};{const t={add(e){const i={obj:e.obj,fields:e.fields||{},curve:e.curve||t.ease,duration:e.duration||1e3,timer:new C(e.duration,!1,e.isUi||!1)},o=new Promise(((e,o)=>{i.resolve=e,i.reject=o,i.starting={};for(const t in i.fields)i.starting[t]=i.obj[t]||0;t.tweens.push(i)}));return e.silent&&(o.catch((()=>{})),i.timer.catch((()=>{}))),o.stop=function(){i.reject({code:0,info:"Stopped by game logic",from:"tween"})},o},linear:(t,e,i)=>e*i+t,ease:(t,e,i)=>(i*=2)<1?e/2*i*i+t:-e/2*(--i*(i-2)-1)+t,easeInQuad:(t,e,i)=>e*i*i+t,easeOutQuad:(t,e,i)=>-e*i*(i-2)+t,easeInCubic:(t,e,i)=>e*i*i*i+t,easeOutCubic:(t,e,i)=>e*(--i*i*i+1)+t,easeInOutCubic:(t,e,i)=>(i*=2)<1?e/2*i*i*i+t:e/2*((i-=2)*i*i+2)+t,easeInOutQuart:(t,e,i)=>(i*=2)<1?e/2*i*i*i*i+t:-e/2*((i-=2)*i*i*i-2)+t,easeInQuart:(t,e,i)=>e*i*i*i*i+t,easeOutQuart:(t,e,i)=>-e*(--i*i*i*i-1)+t,easeInCirc:(t,e,i)=>-e*(Math.sqrt(1-i*i)-1)+t,easeOutCirc:(t,e,i)=>(i--,e*Math.sqrt(1-i*i)+t),easeInOutCirc:(t,e,i)=>(i*=2)<1?-e/2*(Math.sqrt(1-i*i)-1)+t:(i-=2,e/2*(Math.sqrt(1-i*i)+1)+t),easeInBack(t,e,i){const o=1.70158;return e*(2.70158*i*i*i-o*i*i)+t},easeOutBack(t,e,i){const o=1.70158;return e*(1+2.70158*(i-1)**3+o*(i-1)**2)+t},easeInOutBack(t,e,i){const o=2.5949095;return e*(i<.5?(2*i)**2*(7.189819*i-o)/2:((2*i-2)**2*((o+1)*(2*i-2)+o)+2)/2)+t},easeInElastic(t,e,i){const o=2*Math.PI/3;return e*(0===i?0:1===i?1:-(2**(10*i-10))*Math.sin((10*i-10.75)*o))+t},easeOutElastic(t,e,i){const o=2*Math.PI/3;return e*(0===i?0:1===i?1:2**(-10*i)*Math.sin((10*i-.75)*o)+1)+t},easeInOutElastic(t,e,i){const o=2*Math.PI/4.5;return e*(0===i?0:1===i?1:i<.5?-(2**(20*i-10))*Math.sin((20*i-11.125)*o)/2:2**(-20*i+10)*Math.sin((20*i-11.125)*o)/2+1)+t},easeOutBounce(t,e,i){const o=7.5625,n=2.75;let s;return s=i<1/n?o*i*i:i<2/n?o*(i-=1.5/n)*i+.75:i<2.5/n?o*(i-=2.25/n)*i+.9375:o*(i-=2.625/n)*i+.984375,e*s+t},easeInBounce(t,e,i){const o=7.5625,n=2.75;let s;return s=(i=1-i)<1/n?o*i*i:i<2/n?o*(i-=1.5/n)*i+.75:i<2.5/n?o*(i-=2.25/n)*i+.9375:o*(i-=2.625/n)*i+.984375,e*(1-s)+t},easeInOutBounce(t,e,i){const o=7.5625,n=2.75;let s,r;return r=i<.5?1-2*i:2*i-1,s=r<1/n?o*r*r:r<2/n?o*(r-=1.5/n)*r+.75:r<2.5/n?o*(r-=2.25/n)*r+.9375:o*(r-=2.625/n)*r+.984375,s=i<.5?(1-r)/1:(1+r)/1,e*s+t},tweens:[],wait:u.wait};t.easeInOutQuad=t.ease,window.tween=t}const be=function(){const t=function(t,e){rooms.templates.CTTRANSITIONEMPTYROOM.width=camera.width,rooms.templates.CTTRANSITIONEMPTYROOM.height=camera.height;const i=rooms.append("CTTRANSITIONEMPTYROOM",{isUi:!0});return templates.copyIntoRoom(t,0,0,i,Object.assign({room:i},e)).promise};return{fadeOut:(e,i)=>t("CTTRANSITION_FADE",{duration:e=e||500,color:i=i||0,in:!1}),fadeIn:(e,i)=>t("CTTRANSITION_FADE",{duration:e=e||500,color:i=i||0,in:!0}),scaleOut:(e,i,o)=>t("CTTRANSITION_SCALE",{duration:e=e||500,color:o=o||0,scaling:i=i||.1,in:!1}),scaleIn:(e,i,o)=>t("CTTRANSITION_SCALE",{duration:e=e||500,color:o=o||0,scaling:i=i||.1,in:!0}),slideOut:(e,i,o)=>t("CTTRANSITION_SLIDE",{duration:e=e||500,color:o=o||0,endAt:i=i||"right",in:!1}),slideIn:(e,i,o)=>t("CTTRANSITION_SLIDE",{duration:e=e||500,color:o=o||0,endAt:i=i||"right",in:!0}),circleOut:(e,i)=>t("CTTRANSITION_CIRCLE",{duration:e,color:i=i||0,in:!0}),circleIn:(e,i)=>t("CTTRANSITION_CIRCLE",{duration:e,color:i=i||0,in:!1})}}();(()=>{const t={set(t,e){localStorage[t]=JSON.stringify(e)||e.toString()},get(t){let e;try{e=JSON.parse(localStorage[t])}catch(i){e=localStorage[t].toString()}return e},setSession(t,e){sessionStorage[t]=JSON.stringify(e)||e.toString()},getSession(t){let e;try{e=JSON.parse(sessionStorage[t])}catch(i){e=sessionStorage[t].toString()}return e}};window.storage=t})()})();